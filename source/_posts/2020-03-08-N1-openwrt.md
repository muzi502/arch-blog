---
title: N1 ç›’å­åˆ·å…¥ OpenWrt å¹¶éƒ¨ç½² K3s
date: 2020-03-08
updated: 2020-03-08
slug:
categories: åˆ·æœº
tag:
  - è½¯è·¯ç”±
  - OpenWrt
  - K3s
copyright: true
comment: true
---

## K3s

å»å¹´çš„æ—¶å€™å¬äº† Rancher çš„ç›´æ’­åˆ†äº«è®²  [k3såœ¨è¾¹ç¼˜è®¡ç®—ä¸­çš„åº”ç”¨å®è·µ](http://dockone.io/article/9384)ï¼Œå°±æ„Ÿè§‰å¾ˆå¥½ç©å„¿ï¼Œå½“æ—¶å¯¹ K3s è¿˜æ˜¯å¾ˆæ„Ÿå…´è¶£ï¼Œæ— å¥ˆå½“æ—¶æ‰‹å¤´äº†æ²¡æœ‰åˆé€‚çš„å¼€å‘æ¿å¯ç©ï¼Œå°±æ²¡æ„¿æ„èŠ±é’±å†ä¹°å—æ ‘è“æ´¾åƒç°ğŸ˜‚ã€‚ç›´åˆ°ä¸Šå‘¨æœ«çš„æ—¶å€™ä¸€æ¬¡æœºä¼šå¾—ä»¥é‡æ–°è®¤è¯†äº†ä¸€ä¸‹ [K3s](https://github.com/rancher/k3s) æ‰€ä»¥å°±æƒ³æ‰¾ä¸ªè®¾å¤‡æ¥ç©ç© K3sã€‚äºæ˜¯ä¸œæŒ‘è¥¿é€‰å°±é€‰å®šäº†æ–è®¯ N1 ï¼Œä¼˜ç‚¹å¤šå¤šï¼Œä¸ä»…å¯ä»¥åšè·¯ç”±å™¨è¿˜èƒ½è·‘ docker ã€è¿˜èƒ½åš NAS ç­‰ç­‰ï¼Œä¸¤ä¸ªå­—çœŸé¦™ğŸ˜‚ã€‚ä¹‹å‰æˆ‘ä¸€ç›´ä½¿ç”¨ `R6300V2` åˆ·äº†æ¢…æ—ä»¥åŠå¦ä¸€å° `WNDR3700V4` åˆ·äº† `OpenWrt` åšé€æ˜ä»£ç†ï¼Œåœ¨ `ESXi` ä¸Šä¹Ÿè£…äº†ä¸ª `OpenWrt` è½¯è·¯ç”±ç»™å†…ç½‘çš„è™šæ‹Ÿæœºåšé€æ˜ä»£ç†ï¼Œä½†è¿˜æ˜¯å¿ƒæœ‰ä¸ç”˜æƒ³æ‰¾ä¸€å°æ€§èƒ½æ›´å¥½ä¸€ç‚¹çš„è®¾å¤‡æ¥åšæ—è·¯ç½‘å…³ã€‚ç»¼ä¸Šå°±ç§è‰ä¹°äº†æ—©å·²ç»è¢«å¤§å®¶ç©çƒ‚äº†çš„ [N1ç›’å­](https://pockies.github.io/2019/03/07/phicomm-n1/)ã€‚

## å¼€ç®±

### å¤–åŒ…è£…

![image-20200308170852893](https://blog.502.li/img/image-20200308170852893.png)

### æ¥å£

![image-20200308170909549](https://blog.502.li/img/image-20200308170909549.png)

### å¼€æœºç”»é¢

![image-20200308170935704](https://blog.502.li/img/image-20200308170935704.png)

### ç”µè§†ç³»ç»Ÿ

![image-20200308171000114](https://blog.502.li/img/image-20200308171000114.png)

### é…ç½®

#### CPU

- å››æ ¸å¿ƒ `ARMV8` CPU

```ini
â•­â”€root@OpenWrt ~
â•°â”€# cat /proc/cpuinfo
processor       : 0
model name      : ARMv8 Processor rev 4 (v8l)
BogoMIPS        : 48.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x0
CPU part        : 0xd03
CPU revision    : 4

processor       : 1
model name      : ARMv8 Processor rev 4 (v8l)
BogoMIPS        : 48.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x0
CPU part        : 0xd03
CPU revision    : 4

processor       : 2
model name      : ARMv8 Processor rev 4 (v8l)
BogoMIPS        : 48.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x0
CPU part        : 0xd03
CPU revision    : 4

processor       : 3
model name      : ARMv8 Processor rev 4 (v8l)
BogoMIPS        : 48.00
Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid
CPU implementer : 0x41
CPU architecture: 8
CPU variant     : 0x0
CPU part        : 0xd03
CPU revision    : 4
```

#### RAM

- å†…å­˜å¤§çº¦ 2GBï¼Œ1911808K ï¼Ÿï¼Ÿ

```bash
â•­â”€root@OpenWrt ~
â•°â”€# cat /proc/meminfo
MemTotal:        1851688 kB
MemFree:         1278128 kB
MemAvailable:    1639036 kB
â•­â”€root@OpenWrt ~
â•°â”€# dmesg | grep Memory
[    0.000000] Memory: 924744K/1911808K available (12926K kernel code, 1108K rwdata, 5116K rodata, 640K init, 748K bss, 69560K reserved, 917504K cma-reserved)
```

#### ROM

- EMMC å­˜å‚¨å¤§çº¦ 8GB

```bash
â•­â”€root@OpenWrt ~
â•°â”€# fdisk -l /dev/mmcblk1
Disk /dev/mmcblk1: 7.3 GiB, 7818182656 bytes, 15269888 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x7db7c786

Device         Boot   Start      End  Sectors  Size Id Type
/dev/mmcblk1p1      1433600  1695743   262144  128M  c W95 FAT32 (LBA)
/dev/mmcblk1p2      1695744  2744319  1048576  512M 83 Linux
/dev/mmcblk1p3      2744320 15269887 12525568    6G 83 Linux
â•­â”€root@OpenWrt ~
â•°â”€# lsblk
NAME         MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
mmcblk1      179:0    0  7.3G  0 disk
â”œâ”€mmcblk1p1  179:1    0  128M  0 part /boot
â”œâ”€mmcblk1p2  179:2    0  512M  0 part /
â””â”€mmcblk1p3  179:3    0    6G  0 part /mnt/mmcblk1p3
mmcblk1boot0 179:32   0    4M  1 disk
mmcblk1boot1 179:64   0    4M  1 disk
```

#### net

- åƒå…† `1Gbps/Full` ç½‘å¡ä»¥åŠ 2.4GHz/5GHz çš„æ— çº¿ç½‘å¡
- çœ‹åˆ° `RTL8211F` æˆ‘å“­äº†ï¼Œç«Ÿç„¶æ˜¯èƒèŸ¹å¡ï¼Œæ€æ¡Œå„¿ğŸ˜¡

> ï¼ˆN1ä¸æ”¯æŒ RTL8153ï¼Œæ˜¯å› ä¸ºç¡¬ä»¶ä¾›ç”µçš„åŸå› ï¼Œä¸æ˜¯é©±åŠ¨çš„åŸå› ï¼Œä¹Ÿæœ‰ä¸ªåˆ«ç½‘å‹è¯´èƒ½æ”¯æŒçš„ï¼Œå¯èƒ½å› ä¸º rtl8153 ä¹Ÿæœ‰ä¸åŒç‰ˆæœ¬ï¼Œä½†æ”¯ æŒAX88179ï¼Œé€Ÿç‡ 200m å·¦å³, å› æ­¤ä»æ€§èƒ½ä¸Šè€ƒè™‘ï¼ŒN1ä¸å»ºè®®å¤–æ¥ä»»ä½•ç½‘å¡ï¼Œç›´æ¥ç”¨å•ç½‘å¡åšæ—è·¯ç”±ä¹Ÿèƒ½è¾¾åˆ° 750m å·¦å³ï¼‰

```ini
â•­â”€root@OpenWrt ~
â•°â”€# dmesg | grep net
[    0.000000] Kernel command line: root=UUID=69fd696a-85a4-4ec8-b604-4cefd053cbc1 rootfstype=btrfs rootflags=compress=zstd console=ttyAML0,115200n8 console=tty0 no_console_suspend consoleblank=0 fsck.fix=yes fsck.repair=yes net.ifnames=0 cgroup_enable=cpuset cgroup_memory=1 cgroup_enable=memory swapaccount=1
[    0.691325] audit: initializing netlink subsys (disabled)
[    5.131043] meson8b-dwmac c9410000.ethernet: IRQ eth_wake_irq not found
[    5.136694] meson8b-dwmac c9410000.ethernet: IRQ eth_lpi not found
[    5.142854] meson8b-dwmac c9410000.ethernet: PTP uses main clock
[    5.148731] meson8b-dwmac c9410000.ethernet: no reset control found
[    5.155366] meson8b-dwmac c9410000.ethernet: User ID: 0x11, Synopsys ID: 0x37
[    5.162029] meson8b-dwmac c9410000.ethernet:         DWMAC1000
[    5.167192] meson8b-dwmac c9410000.ethernet: DMA HW capability register supported
[    5.174594] meson8b-dwmac c9410000.ethernet: RX Checksum Offload Engine supported
[    5.182017] meson8b-dwmac c9410000.ethernet: COE Type 2
[    5.187192] meson8b-dwmac c9410000.ethernet: TX Checksum insertion supported
[    5.194171] meson8b-dwmac c9410000.ethernet: Wake-Up On Lan supported
[    5.200586] meson8b-dwmac c9410000.ethernet: Normal descriptors
[    5.206426] meson8b-dwmac c9410000.ethernet: Ring mode enabled
[    5.212198] meson8b-dwmac c9410000.ethernet: Enable RX Mitigation via HW Watchdog Timer
[    5.428271] Initializing XFRM netlink socket
[    5.521946] bridge: filtering via arp/ip/ip6tables is no longer available by default. Update your scripts to load br_netfilter if you need this.
[   11.076508] meson8b-dwmac c9410000.ethernet eth0: PHY [0.2009087f:00] driver [RTL8211F Gigabit Ethernet]
[   11.083720] meson8b-dwmac c9410000.ethernet eth0: No Safety Features support found
[   11.088006] meson8b-dwmac c9410000.ethernet eth0: PTP not supported by HW
[   11.094588] meson8b-dwmac c9410000.ethernet eth0: configuring for phy/rgmii link mode
[   19.250095] meson8b-dwmac c9410000.ethernet eth0: PHY [0.2009087f:00] driver [RTL8211F Gigabit Ethernet]
[   19.265579] meson8b-dwmac c9410000.ethernet eth0: No Safety Features support found
[   19.267519] meson8b-dwmac c9410000.ethernet eth0: PTP not supported by HW
[   19.274244] meson8b-dwmac c9410000.ethernet eth0: configuring for phy/rgmii link mode
[   19.411257] netlink: 4 bytes leftover after parsing attributes in process `iw'.
[   19.595853] ieee80211 phy0: brcmf_net_attach: couldn't register the net device
[   19.597447] ieee80211 phy0: brcmf_ap_add_vif: Registering netdevice failed
[   21.019546] meson8b-dwmac c9410000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx
[ 1047.556475] meson8b-dwmac c9410000.ethernet eth0: Link is Down
[ 1047.772626] meson8b-dwmac c9410000.ethernet eth0: PHY [0.2009087f:00] driver [RTL8211F Gigabit Ethernet]
[ 1047.785569] meson8b-dwmac c9410000.ethernet eth0: No Safety Features support found
[ 1047.787510] meson8b-dwmac c9410000.ethernet eth0: PTP not supported by HW
[ 1047.794242] meson8b-dwmac c9410000.ethernet eth0: configuring for phy/rgmii link mode
[ 1051.459018] meson8b-dwmac c9410000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx
[ 1241.984013] netlink: 4 bytes leftover after parsing attributes in process `iw'.
[ 1346.112897] meson8b-dwmac c9410000.ethernet eth0: Link is Down
[ 1346.295582] meson8b-dwmac c9410000.ethernet eth0: PHY [0.2009087f:00] driver [RTL8211F Gigabit Ethernet]
[ 1346.312202] meson8b-dwmac c9410000.ethernet eth0: No Safety Features support found
[ 1346.314172] meson8b-dwmac c9410000.ethernet eth0: PTP not supported by HW
[ 1346.320888] meson8b-dwmac c9410000.ethernet eth0: configuring for phy/rgmii link mode
[ 1349.769672] meson8b-dwmac c9410000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx
```

#### htop

å¼å¼å¼ï¼Œå±…ç„¶è¿˜èƒ½è·‘ Docker ï¼Œé‚£ K3s ä¹Ÿè‚¯å®šæ²¡é—®é¢˜å•¦ï¼ˆ

![image-20200308180733757](https://blog.502.li/img/image-20200308180733757.png)

## å‡†å¤‡

é¦–å…ˆå‡†å¤‡ä¸ªåˆ·æœºè¿‡ç¨‹ä¸­éœ€è¦çš„æ¸…å• ~~åˆ«çœ‹ä½ ä»Šå¤©é—¹å¾—æ¬¢ï¼Œå°å¿ƒä»Šåæ‹‰æ¸…å•~~

- USB å…¬å¯¹å…¬æ•°æ®çº¿ï¼ˆå–å®¶èµ é€äº†çº¿
- ç½‘çº¿æˆ– WiFiï¼Œç½‘çº¿æœ‰æ—¶è·å–ä¸åˆ°æ­£ç¡®çš„ IP ï¼Œå¯ä»¥å€ŸåŠ© WiFi
- HDMI çº¿ä»¥åŠæ˜¾ç¤ºå™¨ï¼Œéœ€è¦è¿›å…¥ç›’å­ç³»ç»Ÿæ‰‹åŠ¨å¼€å¯ adb
- Android SDK å¹³å°å·¥å…· [Platform-tools](https://developer.android.com/studio/releases/platform-tools)
- é•œåƒå†™å…¥å·¥å…· [Rufus](https://github.com/pbatard/rufus) æˆ– [Roadkils DiskImage](https://www.roadkil.net/program.php?ProgramID=12)
- OpenWrt é•œåƒ [N1_Openwrt_R20.2.15_k5.4.23-amlogic-flippy-28+o.7z](https://disk.longe.xyz/N1/Openwrt/28%2Bo%E7%89%88N1_OP_U%E7%9B%98%E7%9B%B4%E5%88%B7%E5%8C%85/N1_Openwrt_R20.2.15_k5.4.23-amlogic-flippy-28%2Bo.7z)

> Openwrt_U ç›˜ç›´åˆ·åŒ…ï¼šé“¾æ¥ï¼šhttps://pan.baidu.com/s/1K0bNItsY1-Br4o1EsRokkg æå–ç ï¼šlidf

### æ¨èèµ„æº

åˆ·æœºè¿‡ç¨‹ä¸­çš„èµ„æºæ¥è‡ªä»¥ä¸‹ï¼Œå¯ä»¥å»è¿™é‡Œæ‰¾æ›´å¤šä½ æƒ³è¦çš„ï¼Œä»–ä»¬çš„æ•™ç¨‹ä¹Ÿä¼šæ¯”æˆ‘æ›´ä¼˜ç§€ä¸€äº›ï¼Œè€Œä¸” B ç«™ä¸Šä¹Ÿæœ‰è§†é¢‘ï¼Œè§†é¢‘è®²è§£çš„è¦æ›´å¥½ã€‚å†™è¿™ç¯‡åšå®¢ä¹Ÿåªæ˜¯ä¸ºäº†è®°å½•ä¸€ä¸‹ğŸ˜‚

- [Pi&N1 Google Drive](https://drive.google.com/drive/folders/1XvhPCwodZzCfV83oW3DXegAvDOrHW7iV)
- [ä¸‰åƒé—®](https://github.com/real-pin1group/3000web/wiki)
- [t.me/PIN1Group](https://t.me/PIN1Group)
- [Pi&N1äº¤æµç¾¤é€šçŸ¥é¢‘é“](https://t.me/NewPiN1Channel)
- [å±±å°ç‚®ç½‘ç›˜](https://disk.longe.xyz/)
- [Phicomm N1åˆ·openwrtè·¯ç”±å›ºä»¶è¯¦ç»†ç¬”è®°.pdf](https://disk.longe.xyz/N1/OpenWrt/%E3%80%902019-6-20%E3%80%91Phicomm%20N1%E5%88%B7openwrt%E8%B7%AF%E7%94%B1%E5%9B%BA%E4%BB%B6%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0.pdf)
- [28+oç‰ˆN1_OP_Uç›˜ç›´åˆ·åŒ…](https://disk.longe.xyz/N1/OpenWrt/28%2Boç‰ˆN1_OP_Uç›˜ç›´åˆ·åŒ…/)
- [[2020-3-8]â˜…29+ç‰ˆN1_OP_Uç›˜ç›´åˆ·åŒ…ï¼ŒåŠè´å£³äº‘_OP_çº¿åˆ·åŒ…ï¼Œå†…æ ¸5.4](https://www.right.com.cn/forum/thread-981406-1-1.html)

## åˆ·æœº

### å¼€å¯ ADB

å°† HDMI çº¿è¿æ¥åˆ°ç›’å­çš„ HDMI å£ï¼Œå°† USB å…¬å¯¹å…¬çš„æ•°æ®çº¿åˆ†åˆ«æ’åœ¨ç›’å­çš„é è¿‘ HDMI å£çš„ USB ï¼Œå¦ä¸€å¤´æ’åœ¨ PC çš„ USB å£ï¼Œå†å°†é¼ æ ‡è¿æ¥åˆ°ç›’å­çš„å¦ä¸€ä¸ª USB å£ã€‚æ’å¥½ä¸Šè¿°çš„çº¿ç¼†ä¹‹åæ’ä¸Šç”µæºå¼€æœºï¼Œç”±äºç›’å­æ²¡æœ‰ç”µæºå¼€å…³æ‰€ä»¥åªèƒ½é€šè¿‡æ’æ‹”ç”µæºçš„æ–¹å¼å¼€å…³æœºã€‚å¼€æœºä¹‹åä¼šè‡ªåŠ¨è¿›å…¥åˆ°ç”µè§†ç›’å­ç³»ç»Ÿçš„é¡µé¢ï¼Œç„¶åæŒªåŠ¨é¼ æ ‡ï¼Œåœ¨ `å›ºä»¶ç‰ˆæœ¬`  é‚£é‡Œç‹‚ç‚¹é¼ æ ‡å››ä¸‹å¼€å¯ `ADB` è°ƒè¯•æ¨¡å¼ã€‚å±å¹•ä¸­é—´ä¼šå¼¹å‡ºä¸ªç°è‰²çš„æ–¹æ¡†æç¤º`æ‰“å¼€ adb`

> PSï¼šæåˆ° adb å’±å°±ä¸ç”±è‡ªä¸»åœ°æƒ³èµ·äº†å»å¹´ä¸–ç•Œäº”ç™¾å¼ºä»–å®¶çš„å·ç§°è¦å–ä»£ Android ã€è‡ªä¸»ç ”å‘ã€å¾®å†…æ ¸ã€é¢å‘ç¡®å®š[æ—¶å»¶](https://zh.wikipedia.org/wiki/æ—¶å»¶)ã€åˆ†å¸ƒå¼ã€å½¢å¼åŒ–éªŒè¯ã€å¤šåœºæ™¯ï¼›å¤§åé¼é¼çš„å“„æ‡µï¼ˆPPTï¼‰æ“ä½œç³»ç»Ÿç«Ÿç„¶ä¹Ÿæœ‰ ADB ï¼ˆå·ç¬‘

åœ¨è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä½¿ç”¨ç½‘çº¿è¿æ¥ç›’å­å’Œè·¯ç”±å™¨åï¼Œå±å¹•ä¸Šæ˜¾ç¤ºçš„ IP å¹¶ä¸æ˜¯æˆ‘æœ¬åœ°å†…ç½‘çš„ IP ï¼Œè¿™ä¸€ç‚¹å¾ˆå¥‡æ€ªï¼Œè€Œä½¿ç”¨æ— çº¿è¿æ¥åˆ°æˆ‘çš„æ— çº¿è·¯ç”±å™¨åå»èƒ½è·å–åˆ°æ­£å¸¸çš„å†…ç½‘ IP ï¼Œæ‰€ä»¥å¦‚æœä½ ä½¿ç”¨ç½‘çº¿è¿æ¥æ—¶ä¹Ÿé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œä¸å¦¨å°è¯•ä¸€ä¸‹ä½¿ç”¨æ— çº¿è¿æ¥ã€‚

![image-20200308171341327](https://blog.502.li/img/image-20200308171341327.png)

### PC ä¸Šè¿æ¥ ADB è¿›å…¥ fastboot æ¨¡å¼

ä¸Šè¿°è¦å°†ç›’å­çš„ HMDI æ¥å…¥æ˜¾ç¤ºå™¨å¹¶æ’ä¸Šé¼ æ ‡ï¼Œå°±æ˜¯ä¸ºäº†åœ¨ ADB æ¨¡å¼ä¸‹è¿›å…¥ fastboot æ¨¡å¼ï¼Œè€Œ fastboot æ¨¡å¼å’Œæˆ‘ä»¬æ™®é€šçš„ Android åˆ·æœºæ—¶çš„ fastboot ä¸€æ ·ï¼Œä½•å†µè¿™ä¸ªç›’å­ä¹Ÿæ˜¯åŸºäº Android çš„ï¼Œæ‰€ä»¥å˜›ï¼Œå’Œ Android åˆ·æœºå¤§åŒå°å¼‚ã€‚ç„¶åä¸‹è½½å¥½ Android SDK å¹³å°å·¥å…· [Platform-tools](https://developer.android.com/studio/releases/platform-tools) å¹¶è§£å‹åˆ°åˆé€‚çš„ä½ç½®ï¼ŒæŒ‰ä½ `shift` é”®ä¹‹åé¼ æ ‡å³é”®ç‚¹å‡»`åœ¨æ­¤å¤„æ‰“å¼€ Powershell çª—å£` ï¼Œæ¥ç€åœ¨è¯¥å‘½ä»¤è¡Œä¸‹è¾“å…¥ `adb.exe connect IP` ï¼Œè¿™é‡Œçš„ IP å³ä¸ºå±å¹•ä¸Šæ˜¾ç¤ºçš„ IP ï¼Œè¿æ¥æˆåŠŸä¹‹åä¼šæœ‰æç¤ºå·²ç»è¿æ¥ã€‚ç„¶åå†è¿è¡Œ `adb.exe shell reboot fastboot` è¿›å…¥ fastboot æ¨¡å¼ã€‚è¿™ä¸€æ­¥å’Œæˆ‘ä»¬ç»™ Android æ‰‹æœºåˆ·æœºæ—¶ä¿ºç”µæºé”®+éŸ³é‡é”®ï¼Œè¿›å…¥ fastboot æ¨¡å¼ä¸€æ ·çš„é“ç†ï¼Œåªä¸è¿‡ç›’å­æ²¡æœ‰éŸ³é‡é”®å’Œå¼€æœºé”®ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ adb çš„æ–¹å¼è¿›å…¥åˆ° fastboot ã€‚

```powershell
PS D:\Desktop> adb.exe connect 192.168.0.105
connected to 192.168.0.105:5555
PS D:\Desktop\N1> adb.exe shell reboot fastboot
```

### åˆ·å…¥é™çº§é•œåƒ

ç›’å­é‡å¯è¿›å…¥ fastboot æ¨¡å¼ä¹‹åï¼ŒPC ä¸Šä¼šæç¤ºæ’å…¥æ–°è®¾å¤‡ï¼Œå¹¶å®å’šå“ä¸€ä¸‹ï¼Œä¹‹åä¼šè‡ªåŠ¨å®‰è£…ä¸Šé©±åŠ¨ç¨‹åºã€‚

å³é”®è®¡ç®—æœº-->ç®¡ç†--> è®¾å¤‡ç®¡ç†å™¨ `LeMobile Android Device`  `Android ADB Interface` å¦‚æœæ²¡æœ‰å‡ºç°è¯¥è®¾å¤‡çš„è¯ï¼Œå¯ä»¥ä¸‹è½½ä¸ªé©±åŠ¨å®‰è£…ç¨‹åºæ¥ç»™ä½ è£…ä¸Šè¯¥è®¾å¤‡çš„é©±åŠ¨ã€‚ä½¿ç”¨ `fastboot devices -l` å‘½ä»¤æ¥æŸ¥çœ‹è¯¥è®¾å¤‡æ˜¯å¦æ­£å¸¸è¿æ¥ä¸Šã€‚

![image-20200308152333262](https://blog.502.li/img/image-20200308152333262.png)

```powershell
PS D:\Desktop\N1> fastboot devices -l
1234567890             fastboot
```

#### æ ¡éªŒé•œåƒ

```ini
Mode                LastWriteTime         Length Name
----          -------------   ------ ----
-a----   2020/3/7     17:53       14191104 boot.img
-a----   2020/3/7     17:53         672256 bootloader.img
-a----   2020/3/7     17:53            605 hash.txt
-a----   2020/3/7     17:53       18295296 recovery.img
# åˆ·æœºä¹‹å‰è¦å…ˆæ ¡éªŒé•œåƒæ˜¯å¦å®Œæ•´æˆ–è€…è¢«ç¯¡æ”¹ï¼Œå…»æˆå¥½ä¹ æƒ¯ğŸ˜‹
PS D:\Desktop\N1> cat .\hash.txt
æ–‡ä»¶: N1_V2.19_imgs\bootloader.img
å¤§å°: 672256 å­—èŠ‚
ä¿®æ”¹æ—¶é—´: 2018å¹´5æœˆ25æ—¥ æ˜ŸæœŸäº”, 23:09:08
MD5: 80BD2EFED2F76B6ECA56F7E026549E1A
SHA1: 3A1FFCADF062748CA1D00EB80E73F2175B160A0D
CRC32: 34BA154A

æ–‡ä»¶: N1_V2.19_imgs\recovery.img
å¤§å°: 18295296 å­—èŠ‚
ä¿®æ”¹æ—¶é—´: 2018å¹´5æœˆ25æ—¥ æ˜ŸæœŸäº”, 23:09:19
MD5: CAC6ED1DED5BB1D9CFAD39B2B1C6CD8A
SHA1: B468A3134B376A5295C1FD5857343128D0AC056C
CRC32: AA11C424

æ–‡ä»¶: N1_V2.19_imgs\boot.img
å¤§å°: 14191104 å­—èŠ‚
ä¿®æ”¹æ—¶é—´: 2018å¹´5æœˆ25æ—¥ æ˜ŸæœŸäº”, 23:09:46
MD5: 75DA954D0C4CBCD4A86CEE501B40C5AA
SHA1: 1A0D04DB8FB57F252C72C909A3268B6B2C3BD241
CRC32: 547D7823

# Windows CMD ä¸‹å¯ä½¿ç”¨ certUtil æ¥è®¡ç®—æ–‡ä»¶çš„ HASH å€¼
PS D:\Desktop\N1> certUtil -hashfile .\recovery.img
SHA1 hash of .\recovery.img:
b468a3134b376a5295c1fd5857343128d0ac056c
CertUtil: -hashfile command completed successfully.
PS D:\Desktop\N1> certUtil -hashfile .\boot.img
SHA1 hash of .\boot.img:
1a0d04db8fb57f252c72c909a3268b6b2c3bd241
CertUtil: -hashfile command completed successfully.
PS D:\Desktop\N1> certUtil -hashfile .\bootloader.img
SHA1 hash of .\bootloader.img:
3a1ffcadf062748ca1d00eb80e73f2175b160a0d
CertUtil: -hashfile command completed successfully.
```

#### è¾“å…¥é™çº§åŒ…é•œåƒ

```bash
# ç„¶åæ ¹æ®å¯¹åº”çš„åˆ†åŒºåˆ·å…¥å¯¹åº”çš„é•œåƒï¼Œè¿™ç‚¹ä¸è¦ææ··ï¼Œä¸ç„¶ä¼šå˜ç –çš„
PS D:\Desktop\N1> fastboot flash bootloader bootloader.img
Sending 'bootloader' (656 KB)                      OKAY [  0.037s]
Writing 'bootloader'                               OKAY [  0.075s]
Finished. Total time: 0.118s
PS D:\Desktop\N1> fastboot flash boot boot.img
Sending 'boot' (13858 KB)                          OKAY [  0.620s]
Writing 'boot'                                     OKAY [  0.666s]
Finished. Total time: 1.290s
PS D:\Desktop\N1> fastboot flash recovery recovery.img
Sending 'recovery' (17866 KB)                      OKAY [  0.802s]
Writing 'recovery'                                 OKAY [  0.869s]
Finished. Total time: 1.684s
PS D:\Desktop\N1>
```

### å°† OpenWrt åˆ·å…¥ EMMC

é™çº§æˆåŠŸä¹‹åæˆ‘ä»¬å°±å¯ä»¥å¼€æœºè¿›å…¥çº¿åˆ·æ¨¡å¼ï¼Œä»è€Œå¯ä»¥é€‰æ‹©ä» U ç›˜è®¾å¤‡å¯åŠ¨ï¼Œä¹‹æ‰€ä»¥é™çº§ä¹Ÿæ˜¯å› ä¸ºè¿™ï¼Œé«˜ç‰ˆæœ¬çš„å›ºä»¶å±è”½äº†è¿™ä¸€åŠŸèƒ½ã€‚æˆ‘ä»¬æ— æ³•ç›´æ¥å°† OpenWrt çš„é•œåƒå†™å…¥åˆ°ç›’å­çš„ EMMC å­˜å‚¨ä¸­ï¼Œè¦è¿›å…¥åˆ°ä¸€ä¸ªå« Armbian çš„åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼Œåœ¨ Armbian ç³»ç»Ÿé‡Œå°† OpenWrt é•œåƒå†™å…¥åˆ° EMMC å­˜å‚¨è®¾å¤‡ä¸­ã€‚è€Œä¹Ÿæœ‰ä¸€äº›å¤§ä½¬å°†äºŒè€…çš„é•œåƒç»“åˆåœ¨ä¸€èµ·ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä½¿ç”¨è¯¥é•œåƒåœ¨ U ç›˜æ¨¡å¼ä¸‹å°† OpenWrt é•œåƒå†™å…¥åˆ° EMMC ä¸­ï¼Œå¹¶ä¸”å‡†å¤‡å¥½äº†è‡ªåŠ¨å†™å…¥çš„è„šæœ¬ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚è¯¥é•œåƒå¯ä»¥ä» [29+ç‰ˆN1_OP_Uç›˜ç›´åˆ·åŒ…ï¼ŒåŠè´å£³äº‘_OP_çº¿åˆ·åŒ…ï¼Œå†…æ ¸5.4](https://www.right.com.cn/forum/thread-981406-1-1.html) æ‰¾åˆ°ã€‚

#### å†™å…¥ U ç›˜é•œåƒ

æˆ‘å†™å…¥ U ç›˜çš„é•œåƒæ˜¯ `N1_Openwrt_R20.2.15_k5.4.23-amlogic-flippy-28+.img` ä¹Ÿå°±æ˜¯ `N1-Openwrt_Uç›˜ç›´åˆ·åŒ…` ï¼Œå†™å…¥å·¥å…·ä½¿ç”¨  [Rufus](https://github.com/pbatard/rufus) æˆ– [Roadkils DiskImage](https://www.roadkil.net/program.php?ProgramID=12) éƒ½å¯ä»¥ï¼Œå°±å’Œæˆ‘ä»¬å¹³æ—¶åˆ¶ä½œå¯åŠ¨ç›˜ä¸€æ ·ã€‚

#### ä» update æ¨¡å¼å¯åŠ¨ Armbian

è¦æ‹”æ‰ USB å…¬å¯¹å…¬çš„çº¿ï¼Œç›’å­å¼€æœºåä½¿ç”¨ bat è„šæœ¬è¿›å…¥çº¿åˆ·æ¨¡å¼ï¼Œåœ¨ update æ¨¡å¼ä¸‹æ‰å¯ä»¥ä»æˆ‘ä»¬åˆšåˆšå†™å…¥çš„é•œåƒ U ç›˜ä¸­å¯åŠ¨ã€‚å¦‚æœä½ ä¸‹è½½å¥½ Google Drive ä¸Šçš„èµ„æºçš„è¯ï¼Œå·¥å…·åœ¨ `/ç©æ³•0--å„ç§ç©æ³•å¿…å¤‡å·¥å…·/2---è¿›çº¿åˆ·æ¨¡å¼å·¥å…·---å¯åŠ¨Uç›˜ç³»ç»Ÿå‰è¦å…ˆè¿›çº¿åˆ·æ¨¡å¼/è¿›çº¿åˆ·æ¨¡å¼å·¥å…·` ä¸‹çš„

```powershell
@echo off
echo æœ¬å·¥å…·é€šè¿‡adbè¿æ¥ä½¿N1é‡å¯è¿›å…¥çº¿åˆ·æ¨¡å¼!
echo è¯·å…ˆç”¨usbåŒå…¬å¤´çº¿è¿æ¥ç›’å­å’Œç”µè„‘!
echo made by webpad
set /p ip=è¯·è¾“å…¥ç›’å­çš„å†…ç½‘IPåœ°å€ï¼š
adb kill-server
if "%ip%" == "" echo æç¤ºï¼šè¯·è¾“å…¥æ­£ç¡®çš„IPåœ°å€ && goto end
echo å¼€å§‹é€šè¿‡ç½‘ç»œè¿›è¡ŒADBè¿æ¥â€¦â€¦
adb connect %ip%
adb devices -l | findstr "p230"
if %ERRORLEVEL% NEQ 0 echo è¿æ¥æµ‹è¯•å¤±è´¥ï¼è¯·ç¡®ä¿å·²å¼€å¯è¿œç¨‹è°ƒè¯•ï¼&&goto end
echo *
echo *
echo *
echo ç›’å­å·²é‡å¯è¿›å…¥çº¿åˆ·æ¨¡å¼ï¼Œè‹¥windowså‘ç°äº†æ–°è®¾å¤‡ï¼Œè¯·åœ¨è®¾å¤‡ç®¡ç†å™¨ä¸­æ‰‹åŠ¨å®‰è£…é©±åŠ¨ï¼Œæ­¤çª—å£å¯ä»¥å…³é—­...
adb shell reboot update
del adbshell.txt >nul 2>nul

:end
echo æŒ‰ä»»æ„é”®é€€å‡º...
pause > nul
```

æ‰§è¡Œå®Œè¯¥è„šæœ¬å**æç¤ºæˆåŠŸè¿›å…¥çº¿åˆ·æ¨¡å¼æ—¶å°±é©¬ä¸Šæ’åˆ·å¥½é•œåƒçš„ U ç›˜** ä¸è¦é”™è¿‡æ—¶æœº(ã€‚ãƒ»âˆ€ãƒ»)ãƒ

å…¶å®è¿™ä¸ªå·¥å…·ä¹Ÿå°±æ˜¯ä¸€æ¡ `adb shell reboot update` æŒ‡ä»¤è€Œå·²ï¼Œ`abd connect  IP ` è¿æ¥åˆ°ç›’å­ä¹‹åï¼Œç„¶åå†æ‰§è¡Œ `adb shell reboot update` ï¼Œç„¶åå†æ’å…¥åˆšåˆšå†™å¥½é•œåƒçš„ U ç›˜ã€‚æ’ä¸Š HMDI çº¿è¿æ¥æ˜¾ç¤ºå™¨å°±ä¼šçœ‹åˆ°æ§åˆ¶ç»ˆç«¯è¾“å‡ºç€å¯åŠ¨æµç¨‹çš„ç”»é¢ï¼Œä¸Šé¢è¿˜æœ‰å››åªå°ä¼é¹…ï¼Œè¿™å°±è¯´æ˜æˆ‘ä»¬æˆåŠŸè¿›å…¥äº† Armbian ç³»ç»Ÿ

#### å°† OpenWrt å†™å…¥åˆ° EMMC å­˜å‚¨ä¸­

```bash
cd /root
./inst-to-emmc.sh
```

è¯¥è„šæœ¬æˆåŠŸæ‰§è¡Œåï¼Œé‡å¯æ‹”æ‰ U ç›˜å°±å¯ä»¥ç›´æ¥è¿›å…¥åˆ° OpenWrt ç³»ç»Ÿä¸­äº†ï¼šï¼‰

## OpenWrt ä¸Šçš„ä¸€äº›å°ä¼˜åŒ–

ä½¿ç”¨  `ifconfig eth0 192.168.0.211 netmask 255.255.255.0` ä¿®æ”¹ eth0 çš„ IP ï¼Œä½†ä¾æ—§æ— æ³• ping é€š 192.168.0.1 ç½‘å…³ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹ LAN å£çš„é…ç½®ã€‚

### ä¿®æ”¹ IP

ç”±äº LAN å£é»˜è®¤çš„æ˜¯ `192.168.1.1` ï¼Œå¦‚æœä½ çš„ç½‘ç»œä¸æ˜¯åœ¨è¯¥ç½‘æ®µä¸‹çš„è¯å°±è¿ä¸ä¸Šè¯¥è®¾å¤‡ï¼Œæ‰€ä»¥å¦‚æœä¸æ˜¯é‡‡ç”¨ç›´è¿ç½‘çº¿çš„è¯ï¼Œè€Œæ˜¯å°†ç›’å­è¿æ¥åœ¨è·¯ç”±å™¨ï¼Œè¿™æ—¶å°±éœ€è¦æ‰‹åŠ¨ä¿®æ”¹ä¸€ä¸‹é»˜è®¤çš„é…ç½®æ‰èƒ½è¿æ¥åˆ°ç›’å­ã€‚

```yaml
config interface 'lan'
        option type 'bridge'
        option ifname 'eth0'
        option proto 'static'
        option netmask '255.255.255.0'
        option dns '119.29.29.29'
        option gateway '192.168.0.1'
        option delegate '0'
        option ipaddr '192.168.0.211'
```

ä¿®æ”¹ä¸€ä¸‹ lan ç½‘å£çš„ IP ä¸ºä½ å†…ç½‘å¯è®¿é—®åˆ°çš„ IP å³å¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¯¥ IP è®¿é—® OpenWrt ç³»ç»Ÿäº†

### å®‰è£…å¿…å¤‡å·¥å…·

```bash
# é¦–å…ˆä¿®æ”¹ä¸€ä¸‹ opkg æºï¼Œé»˜è®¤ç»™è†ç›–ä¸ºä¸­ç§‘å¤§çš„ä»£ç†é•œåƒç«™äº†ï¼Œè¿™ç‚¹ä¸é”™
â•­â”€root@OpenWrt /mnt
â•°â”€# opkg update
Downloading https://openwrt.proxy.ustclug.org/snapshots/targets/armvirt/64/packages/Packages.gz
Updated list of available packages in /var/opkg-lists/openwrt_core
Downloading
```

- git  è¿™æ˜¯å¿…é¡»çš„å‘€
- ca-bundle å’Œ ca-certificatesï¼Œhttps å¿…é¡»è¦ç”¨åˆ°çš„
- git-http å¦‚æœä¸è£…çš„è¯åœ¨ git clone https çš„ repo æ—¶ä¼šæç¤º [â€œUnable to find remote helper for 'https'â€ during git clone](https://stackoverflow.com/questions/8329485/unable-to-find-remote-helper-for-https-during-git-clone)
- zsh å’Œ oh-my-zshï¼Œå¼ºå¤§çš„ shell ä¸ç”¨åºŸè¯ğŸ˜‹

```bash
â•­â”€root@OpenWrt /mnt
â•°â”€# opkg install git zsh git-http ca-bundle ca-certificates wget curl
Package git (2.25.1-1) installed in root is up to date.
Package zsh (5.7.1-1) installed in root is up to date.
Package git-http (2.25.1-1) installed in root is up to date.
Package ca-bundle (20190110-2) installed in root is up to date.
Package ca-certificates (20190110-2) installed in root is up to date.
Upgrading wget on root from 1.20.3-2 to 1.20.3-3...
Downloading https://openwrt.proxy.ustclug.org/snapshots/packages/aarch64_generic/packages/wget_1.20.3-3_aarch64_generic.ipk
Multiple packages (librt and librt) providing same name marked HOLD or PREFER. Using latest.
Upgrading curl on root from 7.66.0-1 to 7.68.0-1...
Downloading https://openwrt.proxy.ustclug.org/snapshots/packages/aarch64_generic/base/curl_7.68.0-1_aarch64_generic.ipk
Configuring curl.
Configuring wget.
```

### éƒ¨ç½²ä¸€ä¸‹ K3s

è¿™é‡Œåªæ˜¯ç®€å•çš„éƒ¨ç½²è¯•ç”¨ä¸€ä¸‹ï¼ŒåæœŸæˆ‘ä¼šè¯¦ç»†è®²ä¸€ä¸‹å…³äº K3s çš„å†…å®¹ã€‚

#### å®˜æ–¹è„šæœ¬

æ ¹æ®å®˜æ–¹çš„è„šæœ¬ä¸€å¥å‘½ä»¤è¡Œ`curl -sfL https://get.k3s.io | sh -`å°±èƒ½è·‘èµ· K3s å‡ºæ¥ï¼Œæ¯”èµ·éš”å£çš„ K8s è¦ç®€å•å¾ˆå¤šå¾ˆå¤šã€‚ä½†æ˜¯è„šæœ¬ä¸€æ‰§è¡Œå°±ç¿»è½¦äº†ğŸ˜‚

```bash
â•­â”€root@OpenWrt ~
â•°â”€# curl -sfL https://get.k3s.io | sh -
[ERROR]  Can not find systemd or openrc to use as a process supervisor for k3s
```

ç”±äº OpenWrt æ²¡æœ‰ systemd å’Œ OpenRC æ¥ç®¡ç†è¿›ç¨‹ï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡è„šæœ¬çš„æ–¹å¼ä¸€é”®éƒ¨ç½²ï¼Œåªèƒ½äºŒè¿›åˆ¶éƒ¨ç½²å•¦ã€‚

#### äºŒè¿›åˆ¶éƒ¨ç½²

åœ¨ K3s çš„ release é¡µé¢ä¸‹è½½åˆ° [k3s-arm64](https://github.com/rancher/k3s/releases/download/v1.17.3%2Bk3s1/k3s-arm64) äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æˆ‘æ”¾åœ¨äº† `/opt/bin/` ç›®å½•ä¸‹ï¼Œå¹¶åœ¨ `.zshrc` è¿½åŠ  `export PATH=/opt/bin:$PATH` ç¯å¢ƒå˜é‡ã€‚

#### usage

```bash
â•­â”€root@OpenWrt ~
â•°â”€# k3s
NAME:
   k3s - Kubernetes, but small and simple

USAGE:
   k3s [global options] command [command options] [arguments...]

VERSION:
   v1.17.3+k3s1 (5b17a175)

COMMANDS:
   server        Run management server
   agent         Run node agent
   kubectl       Run kubectl
   crictl        Run crictl
   ctr           Run ctr
   check-config  Run config check
   help, h       Shows a list of commands or help for one command

GLOBAL OPTIONS:
   --debug        Turn on debug logs [$K3S_DEBUG]
   --help, -h     show help
   --version, -v  print the version
```

#### check-config

å¯åŠ¨ä¸€ä¸ª K3s é›†ç¾¤ä¹‹å‰çº¿ check config ä¸€ä¸‹ä¸‹ğŸ˜‹

```yaml
â•­â”€root@OpenWrt ~
â•°â”€# k3s check-config
INFO[0000] Preparing data dir /var/lib/rancher/k3s/data/a61d93bc56bb3dd34b5ca93517164f5b503e16b6c7414e87b11cf336eeb8ebd7

Verifying binaries in /var/lib/rancher/k3s/data/a61d93bc56bb3dd34b5ca93517164f5b503e16b6c7414e87b11cf336eeb8ebd7/bin:
- sha256sum: good
- links: good

System:
- /usr/sbin iptables v1.8.3 (legacy): ok
- swap: disabled
- routes: ok

Limits:
- /proc/sys/kernel/keys/root_maxkeys: 1000000

modprobe: module configs not found in modules.dep
info: reading kernel config from /proc/config.gz ...

Generally Necessary:
- cgroup hierarchy: properly mounted [/sys/fs/cgroup]
- CONFIG_NAMESPACES: enabled
- CONFIG_NET_NS: enabled
- CONFIG_PID_NS: enabled
- CONFIG_IPC_NS: enabled
- CONFIG_UTS_NS: enabled
- CONFIG_CGROUPS: enabled
- CONFIG_CGROUP_CPUACCT: enabled
- CONFIG_CGROUP_DEVICE: enabled
- CONFIG_CGROUP_FREEZER: enabled
- CONFIG_CGROUP_SCHED: enabled
- CONFIG_CPUSETS: enabled
- CONFIG_MEMCG: enabled
- CONFIG_KEYS: enabled
- CONFIG_VETH: enabled (as module)
- CONFIG_BRIDGE: enabled
- CONFIG_BRIDGE_NETFILTER: enabled (as module)
- CONFIG_NF_NAT_IPV4: missing (fail)
- CONFIG_IP_NF_FILTER: enabled
- CONFIG_IP_NF_TARGET_MASQUERADE: enabled (as module)
- CONFIG_NETFILTER_XT_MATCH_ADDRTYPE: enabled (as module)
- CONFIG_NETFILTER_XT_MATCH_CONNTRACK: enabled
- CONFIG_NETFILTER_XT_MATCH_IPVS: enabled (as module)
- CONFIG_IP_NF_NAT: enabled
- CONFIG_NF_NAT: enabled
- CONFIG_NF_NAT_NEEDED: missing (fail)
- CONFIG_POSIX_MQUEUE: enabled

Optional Features:
- CONFIG_USER_NS: enabled
- CONFIG_SECCOMP: enabled
- CONFIG_CGROUP_PIDS: enabled
- CONFIG_BLK_CGROUP: enabled
- CONFIG_BLK_DEV_THROTTLING: enabled
- CONFIG_CGROUP_PERF: enabled
- CONFIG_CGROUP_HUGETLB: enabled
- CONFIG_NET_CLS_CGROUP: enabled (as module)
- CONFIG_CGROUP_NET_PRIO: enabled
- CONFIG_CFS_BANDWIDTH: enabled
- CONFIG_FAIR_GROUP_SCHED: enabled
- CONFIG_RT_GROUP_SCHED: enabled
- CONFIG_IP_NF_TARGET_REDIRECT: enabled (as module)
- CONFIG_IP_SET: enabled
- CONFIG_IP_VS: enabled (as module)
- CONFIG_IP_VS_NFCT: enabled
- CONFIG_IP_VS_PROTO_TCP: enabled
- CONFIG_IP_VS_PROTO_UDP: enabled
- CONFIG_IP_VS_RR: enabled (as module)
- CONFIG_EXT4_FS: enabled
- CONFIG_EXT4_FS_POSIX_ACL: enabled
- CONFIG_EXT4_FS_SECURITY: enabled
- Network Drivers:
  - "overlay":
    - CONFIG_VXLAN: enabled (as module)
      Optional (for encrypted networks):
      - CONFIG_CRYPTO: enabled
      - CONFIG_CRYPTO_AEAD: enabled
      - CONFIG_CRYPTO_GCM: enabled
      - CONFIG_CRYPTO_SEQIV: enabled
      - CONFIG_CRYPTO_GHASH: enabled
      - CONFIG_XFRM: enabled
      - CONFIG_XFRM_USER: enabled
      - CONFIG_XFRM_ALGO: enabled
      - CONFIG_INET_ESP: enabled
      - CONFIG_INET_XFRM_MODE_TRANSPORT: missing
- Storage Drivers:
  - "overlay":
    - CONFIG_OVERLAY_FS: enabled

STATUS: 2 (fail)

```

å‘ç° `ONFIG_NF_NAT_IPV4: missing (fail)` å’Œ `CONFIG_NF_NAT_NEEDED: missing (fail)` å¤±è´¥äº†ğŸ™ƒï¼Œå…ˆä¸ç®¡çœ‹çœ‹èƒ½ä¸èƒ½è·‘èµ·æ¥å†è¯´ã€‚

#### åˆ›å»º K3s é›†ç¾¤

æ ¹æ® K3s çš„æ–‡æ¡£ï¼Œä½¿ç”¨ `k3s server`  é€‰é¡¹å°±èƒ½åˆ›å»ºä¸€ä¸ª K3s é›†ç¾¤

```bash
â•­â”€root@OpenWrt ~
â•°â”€# k3s server
INFO[2020-03-08T20:17:00.103499172+08:00] Starting k3s v1.17.3+k3s1 (5b17a175)
INFO[2020-03-08T20:17:00.112443368+08:00] Kine listening on unix://kine.sock
INFO[2020-03-08T20:17:01.572347551+08:00] Active TLS secret  (ver=) (count 7): map[listener.cattle.io/cn-10.43.0.1:10.43.0.1 listener.cattle.io/cn-127.0.0.1:127.0.0.1 listener.cattle.io/cn-192.168.0.212:192.168.0.212 listener.cattle.io/cn-kubernetes:kubernetes listener.cattle.io/cn-kubernetes.default:kubernetes.default listener.cattle.io/cn-kubernetes.default.svc.cluster.local:kubernetes.default.svc.cluster.local listener.cattle.io/cn-localhost:localhost listener.cattle.io/hash:089b0c6a0b78e5f9d3a33b154e97185f644ed693bee80d4559c47e00f19af2f8]
INFO[2020-03-08T20:17:01.591244044+08:00] Running kube-apiserver --advertise-port=6443 --allow-privileged=true --anonymous-auth=false --api-audiences=unknown --authorization-mode=Node,RBAC --basic-auth-file=/var/lib/rancher/k3s/server/cred/passwd --bind-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --enable-admission-plugins=NodeRestriction --etcd-servers=unix://kine.sock --insecure-port=0 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=k3s --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key
Flag --basic-auth-file has been deprecated, Basic authentication mode is deprecated and will be removed in a future release. It is not recommended for production environments.
I0308 20:17:01.593861    9319 server.go:622] external host was not specified, using 192.168.0.212
I0308 20:17:01.594884    9319 server.go:163] Version: v1.17.3+k3s1
I0308 20:17:04.485872    9319 plugins.go:158] Loaded 11 mutating admission controller(s) successfully in the following order: NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,MutatingAdmissionWebhook,RuntimeClass.
I0308 20:17:04.485954    9319 plugins.go:161] Loaded 7 validating admission controller(s) successfully in the following order: LimitRanger,ServiceAccount,Priority,PersistentVolumeClaimResize,ValidatingAdmissionWebhook,RuntimeClass,ResourceQuota.
I0308 20:17:04.491004    9319 plugins.go:158] Loaded 11 mutating admission controller(s) successfully in the following order: NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,MutatingAdmissionWebhook,RuntimeClass.
I0308 20:17:04.491084    9319 plugins.go:161] Loaded 7 validating admission controller(s) successfully in the following order: LimitRanger,ServiceAccount,Priority,PersistentVolumeClaimResize,ValidatingAdmissionWebhook,RuntimeClass,ResourceQuota.
I0308 20:17:04.592193    9319 master.go:267] Using reconciler: lease
I0308 20:17:04.699310    9319 rest.go:115] the default service ipfamily for this cluster is: IPv4
W0308 20:17:06.161374    9319 genericapiserver.go:404] Skipping API batch/v2alpha1 because it has no resources.
W0308 20:17:06.212135    9319 genericapiserver.go:404] Skipping API discovery.k8s.io/v1alpha1 because it has no resources.
W0308 20:17:06.264606    9319 genericapiserver.go:404] Skipping API node.k8s.io/v1alpha1 because it has no resources.
W0308 20:17:06.361403    9319 genericapiserver.go:404] Skipping API rbac.authorization.k8s.io/v1alpha1 because it has no resources.
W0308 20:17:06.379432    9319 genericapiserver.go:404] Skipping API scheduling.k8s.io/v1alpha1 because it has no resources.
W0308 20:17:06.447661    9319 genericapiserver.go:404] Skipping API storage.k8s.io/v1alpha1 because it has no resources.
W0308 20:17:06.550084    9319 genericapiserver.go:404] Skipping API apps/v1beta2 because it has no resources.
W0308 20:17:06.550168    9319 genericapiserver.go:404] Skipping API apps/v1beta1 because it has no resources.
I0308 20:17:06.599929    9319 plugins.go:158] Loaded 11 mutating admission controller(s) successfully in the following order: NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,MutatingAdmissionWebhook,RuntimeClass.
I0308 20:17:06.600017    9319 plugins.go:161] Loaded 7 validating admission controller(s) successfully in the following order: LimitRanger,ServiceAccount,Priority,PersistentVolumeClaimResize,ValidatingAdmissionWebhook,RuntimeClass,ResourceQuota.
I0308 20:17:16.394308    9319 dynamic_cafile_content.go:166] Starting client-ca-bundle::/var/lib/rancher/k3s/server/tls/client-ca.crt
I0308 20:17:16.394308    9319 dynamic_cafile_content.go:166] Starting request-header::/var/lib/rancher/k3s/server/tls/request-header-ca.crt
I0308 20:17:16.395251    9319 dynamic_serving_content.go:129] Starting serving-cert::/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt::/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key
I0308 20:17:16.397910    9319 secure_serving.go:178] Serving securely on 127.0.0.1:6444
I0308 20:17:16.398017    9319 tlsconfig.go:219] Starting DynamicServingCertificateController
I0308 20:17:16.398379    9319 autoregister_controller.go:140] Starting autoregister controller
I0308 20:17:16.398459    9319 cache.go:32] Waiting for caches to sync for autoregister controller
I0308 20:17:16.398723    9319 available_controller.go:386] Starting AvailableConditionController
I0308 20:17:16.398794    9319 cache.go:32] Waiting for caches to sync for AvailableConditionController controller
I0308 20:17:16.399089    9319 crdregistration_controller.go:111] Starting crd-autoregister controller
I0308 20:17:16.399288    9319 shared_informer.go:197] Waiting for caches to sync for crd-autoregister
I0308 20:17:16.399546    9319 crd_finalizer.go:263] Starting CRDFinalizer
I0308 20:17:16.399790    9319 controller.go:85] Starting OpenAPI controller
I0308 20:17:16.400002    9319 customresource_discovery_controller.go:208] Starting DiscoveryController
I0308 20:17:16.400341    9319 naming_controller.go:288] Starting NamingConditionController
I0308 20:17:16.400638    9319 establishing_controller.go:73] Starting EstablishingController
I0308 20:17:16.400854    9319 nonstructuralschema_controller.go:191] Starting NonStructuralSchemaConditionController
I0308 20:17:16.401201    9319 apiapproval_controller.go:185] Starting KubernetesAPIApprovalPolicyConformantConditionController
I0308 20:17:16.402017    9319 cluster_authentication_trust_controller.go:440] Starting cluster_authentication_trust_controller controller
I0308 20:17:16.402094    9319 shared_informer.go:197] Waiting for caches to sync for cluster_authentication_trust_controller
I0308 20:17:16.403447    9319 apiservice_controller.go:94] Starting APIServiceRegistrationController
I0308 20:17:16.403537    9319 cache.go:32] Waiting for caches to sync for APIServiceRegistrationController controller
I0308 20:17:16.403681    9319 controller.go:81] Starting OpenAPI AggregationController
I0308 20:17:16.418176    9319 dynamic_cafile_content.go:166] Starting client-ca-bundle::/var/lib/rancher/k3s/server/tls/client-ca.crt
I0308 20:17:16.419045    9319 dynamic_cafile_content.go:166] Starting request-header::/var/lib/rancher/k3s/server/tls/request-header-ca.crt
I0308 20:17:16.606683    9319 shared_informer.go:204] Caches are synced for cluster_authentication_trust_controller
I0308 20:17:16.613199    9319 cache.go:39] Caches are synced for autoregister controller
I0308 20:17:16.614373    9319 cache.go:39] Caches are synced for AvailableConditionController controller
I0308 20:17:16.614504    9319 shared_informer.go:204] Caches are synced for crd-autoregister
I0308 20:17:16.616912    9319 cache.go:39] Caches are synced for APIServiceRegistrationController controller
E0308 20:17:16.633217    9319 controller.go:150] Unable to perform initial Kubernetes service initialization: Service "kubernetes" is invalid: spec.clusterIP: Invalid value: "10.43.0.1": cannot allocate resources of type serviceipallocations at this time
E0308 20:17:16.639707    9319 controller.go:155] Unable to remove old endpoints from kubernetes service: StorageError: key not found, Code: 1, Key: /registry/masterleases/192.168.0.212, ResourceVersion: 0, AdditionalErrorMsg:
I0308 20:17:17.394171    9319 controller.go:107] OpenAPI AggregationController: Processing item
I0308 20:17:17.394300    9319 controller.go:130] OpenAPI AggregationController: action for item : Nothing (removed from the queue).
I0308 20:17:17.394391    9319 controller.go:130] OpenAPI AggregationController: action for item k8s_internal_local_delegation_chain_0000000000: Nothing (removed from the queue).
I0308 20:17:17.431078    9319 storage_scheduling.go:133] created PriorityClass system-node-critical with value 2000001000
I0308 20:17:17.445315    9319 storage_scheduling.go:133] created PriorityClass system-cluster-critical with value 2000000000
I0308 20:17:17.445429    9319 storage_scheduling.go:142] all system priority classes are created successfully or already exist.
I0308 20:17:18.939225    9319 controller.go:606] quota admission added evaluator for: roles.rbac.authorization.k8s.io
I0308 20:17:19.103599    9319 controller.go:606] quota admission added evaluator for: rolebindings.rbac.authorization.k8s.io
W0308 20:17:19.434785    9319 lease.go:224] Resetting endpoints for master service "kubernetes" to [192.168.0.212]
I0308 20:17:19.438264    9319 controller.go:606] quota admission added evaluator for: endpoints
INFO[2020-03-08T20:17:19.626006745+08:00] Running kube-scheduler --bind-address=127.0.0.1 --kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --leader-elect=false --port=10251 --secure-port=0
INFO[2020-03-08T20:17:19.629360634+08:00] Running kube-controller-manager --allocate-node-cidrs=true --bind-address=127.0.0.1 --cluster-cidr=10.42.0.0/16 --cluster-signing-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --leader-elect=false --port=10252 --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=0 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.key --use-service-account-credentials=true
I0308 20:17:19.655674    9319 controllermanager.go:161] Version: v1.17.3+k3s1
I0308 20:17:19.657868    9319 deprecated_insecure_serving.go:53] Serving insecurely on [::]:10252
INFO[2020-03-08T20:17:19.658915754+08:00] Waiting for cloudcontroller rbac role to be created
INFO[2020-03-08T20:17:19.664219593+08:00] Creating CRD addons.k3s.cattle.io
INFO[2020-03-08T20:17:19.686759095+08:00] Creating CRD helmcharts.helm.cattle.io
W0308 20:17:19.691464    9319 authorization.go:47] Authorization is disabled
W0308 20:17:19.691548    9319 authentication.go:92] Authentication is disabled
I0308 20:17:19.691602    9319 deprecated_insecure_serving.go:51] Serving healthz insecurely on [::]:10251
INFO[2020-03-08T20:17:19.762954369+08:00] Waiting for CRD helmcharts.helm.cattle.io to become available
INFO[2020-03-08T20:17:20.280122513+08:00] Done waiting for CRD helmcharts.helm.cattle.io to become available
INFO[2020-03-08T20:17:20.320314726+08:00] Writing static file: /var/lib/rancher/k3s/server/static/charts/traefik-1.81.0.tgz
INFO[2020-03-08T20:17:20.321243908+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/coredns.yaml
INFO[2020-03-08T20:17:20.321700333+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/aggregated-metrics-reader.yaml
INFO[2020-03-08T20:17:20.322113756+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/metrics-apiservice.yaml
INFO[2020-03-08T20:17:20.322546305+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/metrics-server-deployment.yaml
INFO[2020-03-08T20:17:20.322947895+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/metrics-server-service.yaml
INFO[2020-03-08T20:17:20.323365277+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/resource-reader.yaml
INFO[2020-03-08T20:17:20.323768992+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/traefik.yaml
INFO[2020-03-08T20:17:20.324187832+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/ccm.yaml
INFO[2020-03-08T20:17:20.324764300+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/local-storage.yaml
INFO[2020-03-08T20:17:20.325164932+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/auth-delegator.yaml
INFO[2020-03-08T20:17:20.325563897+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/auth-reader.yaml
INFO[2020-03-08T20:17:20.325996113+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/rolebindings.yaml
INFO[2020-03-08T20:17:20.527152139+08:00] Starting k3s.cattle.io/v1, Kind=Addon controller
INFO[2020-03-08T20:17:20.529057920+08:00] Node token is available at /var/lib/rancher/k3s/server/token
INFO[2020-03-08T20:17:20.529286008+08:00] To join node to cluster: k3s agent -s https://192.168.0.212:6443 -t ${NODE_TOKEN}
INFO[2020-03-08T20:17:20.527299933+08:00] Waiting for master node  startup: resource name may not be empty
INFO[2020-03-08T20:17:20.725057527+08:00] Waiting for cloudcontroller rbac role to be created
I0308 20:17:20.810135    9319 controller.go:606] quota admission added evaluator for: addons.k3s.cattle.io
INFO[2020-03-08T20:17:20.830872877+08:00] Starting helm.cattle.io/v1, Kind=HelmChart controller
INFO[2020-03-08T20:17:20.831652182+08:00] Starting batch/v1, Kind=Job controller
INFO[2020-03-08T20:17:20.832798326+08:00] Starting /v1, Kind=Service controller
INFO[2020-03-08T20:17:20.833998971+08:00] Starting /v1, Kind=Pod controller
INFO[2020-03-08T20:17:20.835217450+08:00] Starting /v1, Kind=Endpoints controller
INFO[2020-03-08T20:17:20.836690891+08:00] Starting /v1, Kind=Secret controller
INFO[2020-03-08T20:17:20.838569298+08:00] Starting /v1, Kind=Node controller
```

#### é›†ç¾¤çŠ¶æ€

```bash
â•­â”€root@OpenWrt ~
â•°â”€# ks cluster-info
Kubernetes master is running at https://127.0.0.1:6443
CoreDNS is running at https://127.0.0.1:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
Metrics-server is running at https://127.0.0.1:6443/api/v1/namespaces/kube-system/services/https:metrics-server:/proxy

To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.
```

```bash
â•­â”€root@OpenWrt ~
â•°â”€# ks get node
NAME      STATUS   ROLES    AGE     VERSION
openwrt   Ready    master   5m26s   v1.17.3+k3s1
â•­â”€root@OpenWrt ~
â•°â”€# ks get pod -n kube-system
NAME                                      READY   STATUS              RESTARTS   AGE
metrics-server-6d684c7b5-8gv8j            1/1     Running             0          5m20s
local-path-provisioner-58fb86bdfd-h8jkk   1/1     Running             0          5m20s
svclb-traefik-9kwxx                       0/2     ContainerCreating   0          3m29s
helm-install-traefik-nw9td                0/1     Completed           2          5m20s
coredns-d798c9dd-62sb9                    1/1     Running             0          5m20s
traefik-6787cddb4b-p6hs9                  1/1     Running             0          3m30s
â•­â”€root@OpenWrt ~
â•°â”€# ks describe node
Name:               openwrt
Roles:              master
Labels:             beta.kubernetes.io/arch=arm64
                    beta.kubernetes.io/instance-type=k3s
                    beta.kubernetes.io/os=linux
                    k3s.io/hostname=openwrt
                    k3s.io/internal-ip=192.168.0.212
                    kubernetes.io/arch=arm64
                    kubernetes.io/hostname=openwrt
                    kubernetes.io/os=linux
                    node-role.kubernetes.io/master=true
                    node.kubernetes.io/instance-type=k3s
Annotations:        flannel.alpha.coreos.com/backend-data: {"VtepMAC":"ca:8f:da:03:f3:e5"}
                    flannel.alpha.coreos.com/backend-type: vxlan
                    flannel.alpha.coreos.com/kube-subnet-manager: true
                    flannel.alpha.coreos.com/public-ip: 192.168.0.212
                    node.alpha.kubernetes.io/ttl: 0
                    volumes.kubernetes.io/controller-managed-attach-detach: true
CreationTimestamp:  Sun, 08 Mar 2020 20:17:23 +0800
Taints:             <none>
Unschedulable:      false
Lease:
  HolderIdentity:  openwrt
  AcquireTime:     <unset>
  RenewTime:       Sun, 08 Mar 2020 20:23:44 +0800
Conditions:
  Type                 Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message
  ----               ------  -----------------               ------------------              ------                     -------
  NetworkUnavailable   False   Sun, 08 Mar 2020 20:17:38 +0800   Sun, 08 Mar 2020 20:17:38 +0800   FlannelIsUp                  Flannel is running on this node
  MemoryPressure       False   Sun, 08 Mar 2020 20:19:54 +0800   Sun, 08 Mar 2020 20:17:23 +0800   KubeletHasSufficientMemory   kubelet has sufficient memory available
  DiskPressure         False   Sun, 08 Mar 2020 20:19:54 +0800   Sun, 08 Mar 2020 20:17:23 +0800   KubeletHasNoDiskPressure     kubelet has no disk pressure
  PIDPressure          False   Sun, 08 Mar 2020 20:19:54 +0800   Sun, 08 Mar 2020 20:17:23 +0800   KubeletHasSufficientPID      kubelet has sufficient PID available
  Ready                True    Sun, 08 Mar 2020 20:19:54 +0800   Sun, 08 Mar 2020 20:17:34 +0800   KubeletReady                 kubelet is posting ready status
Addresses:
  InternalIP:  192.168.0.212
  Hostname:    openwrt
Capacity:
  cpu:                4
  ephemeral-storage:  925844Ki
  hugepages-1Gi:      0
  hugepages-2Mi:      0
  hugepages-32Mi:     0
  hugepages-64Ki:     0
  memory:             1851688Ki
  pods:               110
Allocatable:
  cpu:                4
  ephemeral-storage:  900661043
  hugepages-1Gi:      0
  hugepages-2Mi:      0
  hugepages-32Mi:     0
  hugepages-64Ki:     0
  memory:             1851688Ki
  pods:               110
System Info:
  Machine ID:                 96581db4e82a9fb36b0553115e64de1a
  System UUID:
  Boot ID:                    87856a60-0482-4ca3-a144-2ec073e1d2c7
  Kernel Version:             5.4.23-amlogic-flippy-28+
  OS Image:                   OpenWrt SNAPSHOT
  Operating System:           linux
  Architecture:               arm64
  Container Runtime Version:  containerd://1.3.3-k3s1
  Kubelet Version:            v1.17.3+k3s1
  Kube-Proxy Version:         v1.17.3+k3s1
PodCIDR:                      10.42.0.0/24
PodCIDRs:                     10.42.0.0/24
ProviderID:                   k3s://openwrt
Non-terminated Pods:          (5 in total)
  Namespace                   Name                                       CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE
  ---------                 ----                                     ------------  ----------  ---------------  -------------  ---
  kube-system                 metrics-server-6d684c7b5-8gv8j             0 (0%)        0 (0%)      0 (0%)           0 (0%)         6m10s
  kube-system                 local-path-provisioner-58fb86bdfd-h8jkk    0 (0%)        0 (0%)      0 (0%)           0 (0%)         6m10s
  kube-system                 svclb-traefik-9kwxx                        0 (0%)        0 (0%)      0 (0%)           0 (0%)         4m19s
  kube-system                 coredns-d798c9dd-62sb9                     100m (2%)     0 (0%)      70Mi (3%)        170Mi (9%)     6m10s
  kube-system                 traefik-6787cddb4b-p6hs9                   0 (0%)        0 (0%)      0 (0%)           0 (0%)         4m20s
Allocated resources:
  (Total limits may be over 100 percent, i.e., overcommitted.)
  Resource           Requests   Limits
  --------         -------- ------
  cpu                100m (2%)  0 (0%)
  memory             70Mi (3%)  170Mi (9%)
  ephemeral-storage  0 (0%)     0 (0%)
Events:
  Type     Reason                   Age                    From                 Message
  ----   ------                 ----                 ----               -------
  Normal   Starting                 6m24s                  kubelet, openwrt     Starting kubelet.
  Warning  InvalidDiskCapacity      6m24s                  kubelet, openwrt     invalid capacity 0 on image filesystem
  Normal   NodeHasSufficientPID     6m23s (x2 over 6m24s)  kubelet, openwrt     Node openwrt status is now: NodeHasSufficientPID
  Normal   NodeHasSufficientMemory  6m23s (x2 over 6m24s)  kubelet, openwrt     Node openwrt status is now: NodeHasSufficientMemory
  Normal   NodeHasNoDiskPressure    6m23s (x2 over 6m24s)  kubelet, openwrt     Node openwrt status is now: NodeHasNoDiskPressure
  Normal   NodeAllocatableEnforced  6m23s                  kubelet, openwrt     Updated Node Allocatable limit across pods
  Normal   Starting                 6m23s                  kube-proxy, openwrt  Starting kube-proxy.
  Normal   NodeReady                6m13s                  kubelet, openwrt     Node openwrt status is now: NodeReady
```

## ç»“æŸå•¦

å…³äº OpenWrt æœ€é‡è¦çš„`é€æ˜ä»£ç†æ—è·¯ç½‘å…³` è¿˜æ²¡æœ‰è®²åˆ°ï¼Œç¨åå†æ›´æ–°ä¸€ä¸‹ï¼Œæ¯•ç«Ÿæˆ‘ä¹°äº†æ˜¯ç©å„¿ K3s çš„ğŸ˜‚ã€‚æ€»ä¹‹è¿™ä¸ªåƒåœ¾è¿˜æ˜¯å€¼å¾—æ¡çš„ï¼Œå‡†å¤‡å†æ¡å‡ å°ï¼Ÿéƒ¨ç½²ä¸ª K3s é›†ç¾¤ï¼Ÿé«˜å¯ç”¨ï¼Ÿäº”èŠ‚ç‚¹ï¼Ÿä»¨ master ä¿© nodeï¼Ÿï¼ˆé€ƒ

ä¸è¿‡æ„å¤–å‘ç°è¯¥ç›’å­çš„ USB å£ç«Ÿç„¶æ”¯æŒä½¿ç”¨ echo å‘½ä»¤æ¥ä¿®æ”¹ `/sys/bus/usb/devices/usb1/power/level` çš„å€¼æ¥æ§åˆ¶ USB çš„ç”µæºçŠ¶æ€ï¼Œè¿™æ ·ä»USB å£å¼•å‡ºæ­£è´Ÿææ¥åœ¨ç»§ç”µå™¨ä¸Šï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé€šè¿‡ç½‘ç»œæ§åˆ¶çš„å¼€å…³ã€‚æˆ‘åœ¨ `R6300V2` å’Œ `WNDR3700V4` ä¸Šæ¢¦å¯ä»¥æ±‚æ²¡æœ‰çš„åŠŸèƒ½å±…ç„¶åœ¨è¿™ä¸ªç ´ç›’å­ä¸Šæœ‰ã€‚æ„å¤–æ”¶è·ï¼

```bash
â•­â”€root@OpenWrt ~
â•°â”€# tree /sys/bus/usb/devices/usb1/power/
/sys/bus/usb/devices/usb1/power/
â”œâ”€â”€ active_duration
â”œâ”€â”€ autosuspend
â”œâ”€â”€ autosuspend_delay_ms
â”œâ”€â”€ connected_duration
â”œâ”€â”€ control
â”œâ”€â”€ level
â”œâ”€â”€ runtime_active_time
â”œâ”€â”€ runtime_status
â”œâ”€â”€ runtime_suspended_time
â”œâ”€â”€ wakeup
â”œâ”€â”€ wakeup_abort_count
â”œâ”€â”€ wakeup_active
â”œâ”€â”€ wakeup_active_count
â”œâ”€â”€ wakeup_count
â”œâ”€â”€ wakeup_expire_count
â”œâ”€â”€ wakeup_last_time_ms
â”œâ”€â”€ wakeup_max_time_ms
â””â”€â”€ wakeup_total_time_ms
```

æœ€åç¥å¤§å®¶ **Happy Hacking**
