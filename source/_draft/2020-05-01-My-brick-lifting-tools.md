---
title: æœ¨å­çš„æ¬ç –å·¥å…·ğŸ˜‚
date: 2020-05-11
updated:
slug:
categories: æŠ€æœ¯
tag:
  - Linux
  - æ¬ç –
  - å·¥å…·
  - å‘½ä»¤è¡Œ
copyright: true
comment: true
---

ä¿—è¯è¯´**å¥½äººä¿®ç”µè„‘ï¼ŒåäººåºŠä¸Šæï¼›ç”µè„‘ä¿®å¾—å¥½ï¼Œå¥½äººå½“åˆ°è€ã€‚** ä½œä¸ºä¸€å`é¢å‘æ–‡æ¡£ç¼–ç¨‹`çš„è¿ç»´å·¥ç¨‹å¸ˆï¼Œä¸»ä¸šä¹Ÿæ— éå°±æ˜¯æ“é›†ç¾¤æ“è™šæ‹Ÿæœºæ“é•œåƒï¼Œçº¿ä¸Šç¯å¢ƒé‡åˆ°æ•…éšœå°±åœ¨ StackOverflow æ¬ä¸€äº› ~~Code~~ ç –æ¥è§£å†³é—®é¢˜ï¼Œå¸®åŒäº‹é…ç½®ä¸€ä¸‹ CI/CD æµæ°´çº¿ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜è¦ 7*24 å°æ—¶ on-callã€‚å¦‚æœè¿›å…¥ IDC æœºæˆ¿çš„è¯è¿˜è¦æœ‰ä¸€èº«æ‰› 2U æœåŠ¡å™¨åå±‚æ¥¼ä¸æ¢ğŸ™‹â€â™‚ï¸æœ¬é¢†ã€‚

## Linux

ç¡®åˆ‡åœ°æ¥è®² Linux ä»…ä»…æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„å†…æ ¸ï¼Œè€Œä¸”å®ƒçš„ä»£ç åœ¨ä¸€ä¸ªå‘è¡Œç‰ˆä¸­çš„å ç”¨ç‡ä¹Ÿä¸åˆ° 20%ã€‚

### å…¥é—¨

å’±ä¸€ç›´è§‰ç€å­¦ä¹ æŠ€æœ¯å§ï¼Œå¹¶ä¸æ˜¯çœ‹ä¹¦çœ‹è§†é¢‘èƒ½å­¦ä¼šçš„ã€‚å¯¹äºä¸€äº›åº•å±‚çš„åªæ˜¯ç¡®å®éœ€è¦ä»”ç»†ç ”è¯»ä¹¦ç±æ¥åƒé€ä»–ï¼Œè¿™è¶Ÿä¼šè®©æˆ‘ä»¬å¯¹æ“ä½œç³»ç»Ÿè¿™ä¸ªä½“ç³»ç»“æ„æœ‰æ›´ä¸‹é€å½»çš„è®¤è¯†ã€‚ä½†æ˜¯å‘¢ï¼Œå…‰çœ‹ä¸ç»ƒè¿˜æ˜¯ä¸è¡Œæ»´ï¼Œå’±å­¦ä¹  Linux çº¯é çç©ï¼ŒçæŠ˜è…¾ã€‚å’±å¤§å­¦æ—¶å­¦æ ¡æ²¡æœ‰å¼€è®¾ Linux è¯¾ç¨‹ï¼Œåªèƒ½é è‡ªå·±è‡ªå­¦ã€‚äºæ˜¯ä¹ï¼Œå’Œå¤§å®¶ä¸€æ ·ï¼Œæ­å»º WordPress ï¼Œä¸€æ­¥æ­¥å®‰è£… LAMP ç¯å¢ƒï¼Œé…ç½® iptablesï¼Œå†™ shell è„šæœ¬å¤‡ä»½ç½‘ç«™ï¼Œæ­å»ºæ¢¯å­ç­‰ç­‰ã€‚å¯è°“æ˜¯ç©å¾—ä¸äº¦ä¹ä¹ğŸ˜‚ã€‚

æ‰€ä»¥è¯´å­¦ä¹ å’Œå…¥é—¨ Linux å’±è¿˜æ˜¯æ¨èé¸Ÿå“¥çš„ã€Šé¸Ÿå“¥ Linux ç§æˆ¿èœã€‹è¿™æœ¬ä¹¦ï¼Œç»“åˆç€è‡ªå·±æ­å»ºç½‘ç«™ä¸€æ­¥æ­¥æ¥å°±å¯ä»¥ã€‚

### æ”¾å¼ƒ

å…¥é—¨å®Œ Linux ä¹‹åå°±å¼€å§‹æŒ‘æˆ˜é«˜éš¾åº¦çš„å•¦ï¼Œæ¯”å¦‚ï¼š

- OpenStack
- Docker
- Kubernetes
- CI/CD

ç›®å‰æ¥è®²åœ¨è¿ç»´è¿™ä¸ªæ¬ç –è¡Œä¸šï¼Œkubernetes äº‘åŸç”Ÿæ— ç–‘æ˜¯æœ€å…·æœ‰æŒ‘æˆ˜æ€§å’Œå‰æ™¯çš„ï¼Œæ‰€ä»¥å¦‚æœå“ˆæƒ³æ›´è¿‘ä¸€å±‚æ¥¼å°±ä¸å¦¨å­¦ä¹ ä¸€ä¸‹ Docker å’Œ Kuberneets è¿™ä¸€å—ã€‚

### å‘è¡Œç‰ˆ

ä»è¿ç»´è¿™ä¸ªæ¬ç –è¡Œä¸šæ¥è®²ï¼Œä¼ä¸šå†…éƒ¨ä½¿ç”¨çš„ Linux å‘è¡Œç‰ˆå½“å± RedHat å’Œ Debian å®¶æ—çš„æœ€å¤šï¼Œåƒå…¶ä»–çš„ä»€ä¹ˆ archlinux å’±è¿˜çœŸæ²¡è§è¿‡æœ‰åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„ï¼Œæ¯•ç«Ÿæ»šåŠ¨æ›´æ–°ä¸å°å¿ƒå°±æ»šæŒ‚äº†ä¸å¥½è¯´ğŸ˜‚ã€‚å›½å†…ä¼ä¸šå’Œäº‘è®¡ç®—å‚å•†ä½¿ç”¨æœ€å¤šçš„å½“ç„¶æ˜¯ CentOS å•¦ï¼Œæˆ‘è®°å¾—æ˜¯åœ¨ 2018 å¹´å¹´æœ«çš„æ—¶å€™é˜¿é‡Œäº‘/è…¾è®¯äº‘è¿˜æ²¡æœ‰ Ubuntu 1804 çš„äº‘ä¸»æœºå¯ç”¨ğŸ˜‘ã€‚å›½å¤–ä½¿ç”¨ Ubuntu çš„è¾ƒå¤šä¸€äº›ï¼Œå’±æ˜¯å€¾å‘äºä½¿ç”¨ Ubuntu ğŸ˜

ä» [datanyze](https://www.datanyze.com) å®¶å·æ¥ä¸€å¼ ä¼ä¸š Linux å¸‚åœºå æœ‰ç‡çš„ç»Ÿè®¡è¡¨æ ¼ [Operating Systems](https://www.datanyze.com/market-share/operating-systems--443)ğŸ˜‚

| Ranking | Technology                                                   | Domains | Market Share |
| :-----: | :----------------------------------------------------------- | ------: | -----------: |
|    1    | [Ubuntu](https://www.datanyze.com/market-share/operating-systems--443/ubuntu-market-share) | 278,611 |       29.30% |
|    2    | [Unix](https://www.datanyze.com/market-share/operating-systems--443/unix-market-share) | 192,215 |       20.21% |
|    3    | [CentOS](https://www.datanyze.com/market-share/operating-systems--443/centos-market-share) | 165,640 |       17.42% |
|    4    | [Debian](https://www.datanyze.com/market-share/operating-systems--443/debian-market-share) | 108,373 |       11.40% |
|    5    | [Linux](https://www.datanyze.com/market-share/operating-systems--443/linux-market-share) |  24,563 |        2.58% |
|    6    | [Windows Server](https://www.datanyze.com/market-share/operating-systems--443/windows-server-market-share) |  23,872 |        2.51% |
|    7    | [Gentoo](https://www.datanyze.com/market-share/operating-systems--443/gentoo-market-share) |  16,756 |        1.76% |
|    8    | [Red Hat Enterprise Linux](https://www.datanyze.com/market-share/operating-systems--443/red-hat-enterprise-linux-market-share) |  13,659 |        1.44% |
|    9    | [Windows 7](https://www.datanyze.com/market-share/operating-systems--443/windows-7-market-share) |  11,843 |        1.25% |
|   10    | [Microsoft Windows OS](https://www.datanyze.com/market-share/operating-systems--443/microsoft-windows-os-market-share) |  10,986 |        1.16% |

| op Competitors                                               | Websites | Market Share |                                                  Versus Page |
| :----------------------------------------------------------- | -------: | -----------: | -----------------------------------------------------------: |
| [Ubuntu](https://www.datanyze.com/market-share/operating-systems--443/ubuntu-market-share) |  278,611 |       29.30% | [Linux vs. Ubuntu](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-ubuntu) |
| [Unix](https://www.datanyze.com/market-share/operating-systems--443/unix-market-share) |  192,215 |       20.21% | [Linux vs. Unix](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-unix) |
| [CentOS](https://www.datanyze.com/market-share/operating-systems--443/centos-market-share) |  165,640 |       17.42% | [Linux vs. CentOS](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-centos) |
| [Debian](https://www.datanyze.com/market-share/operating-systems--443/debian-market-share) |  108,373 |       11.40% | [Linux vs. Debian](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-debian) |
| [Windows Server](https://www.datanyze.com/market-share/operating-systems--443/windows-server-market-share) |   23,872 |        2.51% | [Linux vs. Windows Server](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-windows-server) |
| [Gentoo](https://www.datanyze.com/market-share/operating-systems--443/gentoo-market-share) |   16,756 |        1.76% | [Linux vs. Gentoo](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-gentoo) |
| [Red Hat Enterprise Linux](https://www.datanyze.com/market-share/operating-systems--443/red-hat-enterprise-linux-market-share) |   13,659 |        1.44% | [Linux vs. Red Hat Enterprise Linux](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-red-hat-enterprise-linux) |
| [Windows 7](https://www.datanyze.com/market-share/operating-systems--443/windows-7-market-share) |   11,843 |        1.25% | [Linux vs. Windows 7](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-windows-7) |
| [Microsoft Windows OS](https://www.datanyze.com/market-share/operating-systems--443/microsoft-windows-os-market-share) |   10,986 |        1.16% | [Linux vs. Microsoft Windows OS](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-microsoft-windows-os) |
| [FreeBSD](https://www.datanyze.com/market-share/operating-systems--443/freebsd-market-share) |    9,633 |        1.01% | [Linux vs. FreeBSD](https://www.datanyze.com/market-share/operating-systems--443/linux-vs-freebsd) |

#### RedHat/CentOS

#### Debian/Ubuntu

å’±çš„ VPS æ¸…ä¸€è‰² Ubuntu 1804 ï¼Œä¸»è¦æ˜¯çœäº‹å„¿ã€‚

## å‘½ä»¤è¡Œå·¥å…·

### æ–‡æœ¬å¤„ç†

æåˆ° Linux ä¸Šçš„æ–‡æœ¬å¤„ç†å·¥å…·å½“ç„¶æ˜¯ç¦»ä¸å¼€ä¸‰å‰‘å®¢ï¼ˆawkã€grepã€sedï¼‰ï¼Œè¿™ä¹Ÿæ˜¯å’±å½“åˆè·Ÿç€ã€Šé¸Ÿå“¥ Linux ç§æˆ¿èœã€‹å­¦æ¥çš„ğŸ˜‚ã€‚

#### sed

#### awk

#### grep

#### jq

#### tr

#### sort

#### wc

#### join

#### cut

### ç³»ç»Ÿä¿¡æ¯

#### htop

top é»‘ä¹ä¹çš„é¢œå€¼å¤ªä½äº†ï¼Œå’±è¿˜æ˜¯å–œæ¬¢èŠ±èŠ±ç»¿ç»¿çš„ htop ï¼ˆå¤§é›¾

- install

```shell
# RHEL/CentOS
yum install htop

# Debian/Ubuntu
apt install htop
```

![image-20200506142544440](img/image-20200506142544440.png)

### [bashtop](https://github.com/aristocratos/bashtop)

- install

å®‰è£…èµ·æ¥å¾ˆç®€å•ï¼Œå…¶å®è¿™æ˜¯ä¸€ä¸ª shell å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç›´æ¥ä½¿ç”¨ curl æˆ–è€… wget å‘½ä»¤ä¸‹è½½åˆ°æœ¬åœ°å¹¶èµ‹äºˆ +x æƒé™å³å¯ã€‚

```shell
curl -fsSL https://raw.githubusercontent.com/aristocratos/bashtop/master/bashtop -o /usr/bin/bashtop && chmod +x /usr/bin/bashtop
```

å›½å†…ç”¨æˆ·æ¨èä½¿ç”¨ jsdelivr.net çš„ CDN æ¥ä¸‹è½½è¯¥è„šæœ¬ğŸ˜‘ï¼Œï¼ˆfuck GFW by jsdelivrğŸ˜¡

```shell
curl -fsSL https://cdn.jsdelivr.net/gh/aristocratos/bashtop/bashtop  -o /usr/bin/bashtop ;chmod +x /usr/bin/bashtop
```

![image-20200506151706148](img/image-20200506151706148.png)

#### pstree

- install

```shell
# RHEL/CentOS
yum install psmisc

# Debian/Ubuntu
apt install psmisc
```

- output example

```shell
â•­â”€root@k8s-node-3 /proc
â•°â”€# pstree
systemdâ”€â”¬â”€agetty
        â”œâ”€auditdâ”€â”€â”€{auditd}
        â”œâ”€containerdâ”€â”¬â”€6*[containerd-shimâ”€â”¬â”€pause]
        â”‚            â”‚                    â””â”€9*[{containerd-shim}]]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€kube-proxyâ”€â”€â”€12*[{kube-proxy}]
        â”‚            â”‚                 â””â”€9*[{containerd-shim}]
        â”‚            â”œâ”€4*[containerd-shimâ”€â”¬â”€pause]
        â”‚            â”‚                    â””â”€10*[{containerd-shim}]]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€lvscareâ”€â”€â”€11*[{lvscare}]
        â”‚            â”‚                 â””â”€10*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€agentâ”€â”€â”€10*[{agent}]
        â”‚            â”‚                 â””â”€10*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€runsvdirâ”€â”¬â”€runsvâ”€â”€â”€bird6
        â”‚            â”‚                 â”‚          â”œâ”€runsvâ”€â”€â”€calico-nodeâ”€â”€â”€18*[{calico-node}]
        â”‚            â”‚                 â”‚          â”œâ”€runsvâ”€â”€â”€calico-nodeâ”€â”€â”€15*[{calico-node}]
        â”‚            â”‚                 â”‚          â””â”€runsvâ”€â”€â”€bird
        â”‚            â”‚                 â””â”€12*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€node_exporterâ”€â”€â”€4*[{node_exporter}]
        â”‚            â”‚                 â””â”€10*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€nginx-proxyâ”€â”¬â”€confdâ”€â”€â”€11*[{confd}]
        â”‚            â”‚                 â”‚             â””â”€nginxâ”€â”€â”€nginx
        â”‚            â”‚                 â””â”€9*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€deploy.shâ”€â”€â”€sleep
        â”‚            â”‚                 â””â”€10*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€nginx-ingressâ”€â”¬â”€nginxâ”€â”€â”€4*[nginx]
        â”‚            â”‚                 â”‚               â””â”€14*[{nginx-ingress}]
        â”‚            â”‚                 â””â”€10*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€configmap-reloaâ”€â”€â”€4*[{configmap-reloa}]
        â”‚            â”‚                 â””â”€9*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€bash
        â”‚            â”‚                 â””â”€9*[{containerd-shim}]
        â”‚            â”œâ”€containerd-shimâ”€â”¬â”€ruby2.3â”€â”¬â”€ruby2.3â”€â”€â”€4*[{ruby2.3}]
        â”‚            â”‚                 â”‚         â””â”€11*[{ruby2.3}]
        â”‚            â”‚                 â””â”€10*[{containerd-shim}]
        â”‚            â””â”€46*[{containerd}]
        â”œâ”€crond
        â”œâ”€dbus-daemonâ”€â”€â”€{dbus-daemon}
        â”œâ”€dockerdâ”€â”€â”€25*[{dockerd}]
        â”œâ”€gssproxyâ”€â”€â”€5*[{gssproxy}]
        â”œâ”€irqbalance
        â”œâ”€kubeletâ”€â”€â”€26*[{kubelet}]
        â”œâ”€lvmetad
        â”œâ”€polkitdâ”€â”€â”€6*[{polkitd}]
        â”œâ”€rpc.idmapd
        â”œâ”€rpc.mountd
        â”œâ”€rpc.statd
        â”œâ”€rpcbind
        â”œâ”€rsyslogdâ”€â”€â”€2*[{rsyslogd}]
        â”œâ”€sshdâ”€â”€â”€sshdâ”€â”€â”€zshâ”€â”€â”€pstree
        â”œâ”€systemd-journal
        â”œâ”€systemd-logind
        â”œâ”€systemd-udevd
        â””â”€tunedâ”€â”€â”€4*[{tuned}]
```

#### ncdu

ä½¿ç”¨ `ncdu` çš„å¥½å¤„å°±æ˜¯å¯ä»¥é€šè¿‡äº¤äº’å¼çš„æ–¹å¼æŸ¥çœ‹ç›®å½•å ç”¨ç©ºé—´çš„å¤§å°ï¼Œè¦æ¯” `du -sh` å‘½ä»¤æ–¹ä¾¿å¾ˆå¤š

- install

```shell
# RHEL/CentOS
yum install ncdu

# Debian/Ubuntu
apt install ncdu
```

- output example

ä½¿ç”¨åå‘é”®å’Œå›è½¦é”®è¿›è¡Œç›®å½•å¥‡å¹»ï¼Œå¾ˆæ–¹ä¾¿çš„è¯´ğŸ˜‚

```shell
ncdu 1.13 ~ Use the arrow keys to navigate, press ? for help
--- / ------------
    5.2 GiB [##########] /var
    2.2 GiB [####      ] /opt
    2.0 GiB [###       ] /usr
  363.6 MiB [          ] /root
	45.8 MiB [          ] /boot
	45.2 MiB [          ] /run
	 4.6 MiB [          ] /etc
	44.0 KiB [          ] /tmp
	24.0 KiB [          ] /home
e  16.0 KiB [          ] /lost+found
	 8.0 KiB [          ] /media
e   4.0 KiB [          ] /srv
e   4.0 KiB [          ] /mnt
.   0.0   B [          ] /proc
	 0.0   B [          ] /sys
	 0.0   B [          ] /dev
@   0.0   B [          ]  initrd.img.old
@   0.0   B [          ]  initrd.img
@   0.0   B [          ]  vmlinuz.old
@   0.0   B [          ]  vmlinuz
@   0.0   B [          ]  libx32
@   0.0   B [          ]  lib64
@   0.0   B [          ]  lib32
@   0.0   B [          ]  sbin

ncdu 1.13 ~ Use the arrow keys to navigate, press ? for help
--- /var --------------
	 3.5 GiB [##########] /lib
	 1.4 GiB [####      ] /opt
  156.9 MiB [          ] /cache
	79.6 MiB [          ] /log
	 1.8 MiB [          ] /backups
	20.0 KiB [          ] /tmp
	16.0 KiB [          ] /spool
e   4.0 KiB [          ] /mail
e   4.0 KiB [          ] /local
@   0.0   B [          ]  lock
@   0.0   B [          ]  run
```

- G/GB

> The SIZE argument is an integer and optional unit (example: 10K is 10*1024). Units are K,M,G,T,P,E,Z,Y (powers of 1024) or KB,MB,... (powers of 1000).

#### nload

- install

```shell
# RHEL/CentOS
yum install nload

# Debian/Ubuntu
apt install nload
```

- output example

æŒ‰ä¸‹å›è½¦é”®å¯ä»¥åˆ‡æ¢ä¸åŒçš„ç½‘å¡

![image-20200506143310955](img/image-20200506143310955.png)

### ls å…„å¼Ÿä»¬

```bash
â•­â”€root@gitlab /opt
â•°â”€# ls
ls           lsblk        LS_COLORS    lsinitramfs  lslogins     lsns         lspgpot
lsa          lsb_release  lscpu        lsipc        lsmem        lsof
lsattr       LSCOLORS     lshw         lslocks      lsmod        lspci
```

#### ls

> ls - list directory contents åˆ—å‡ºæ–‡ä»¶å¤¹å†…å®¹

#### lsattr

> lsattr - list file attributes on a Linux second extended file system

#### lsblk

> lsblk - list block devices åˆ—å‡ºå—è®¾å¤‡

```bash
â•­â”€root@gitlab /opt
â•°â”€# lsblk
NAME                      MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
sda                         8:0    0  30G  0 disk
â”œâ”€sda1                      8:1    0   1M  0 part
â”œâ”€sda2                      8:2    0   1G  0 part /boot
â””â”€sda3                      8:3    0  29G  0 part
  â””â”€ubuntu--vg-ubuntu--lv 253:0    0  28G  0 lvm  /
```

#### lsb_release

> lsb_release - print distribution-specific information æ‰“å°å‘è¡Œç‰ˆè¯¦æƒ…

#### lscpu

> lscpu - display information about the CPU architecture

`lscpu`

```yaml
â•­â”€root@gitlab /opt
â•°â”€# lscpu
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              4
On-line CPU(s) list: 0-3
Thread(s) per core:  1
Core(s) per socket:  1
Socket(s):           4
NUMA node(s):        1
Vendor ID:           GenuineIntel
CPU family:          6
Model:               60
Model name:          Intel(R) Xeon(R) CPU E3-1271 v3 @ 3.60GHz
Stepping:            3
CPU MHz:             3591.683
BogoMIPS:            7183.36
Hypervisor vendor:   VMware
Virtualization type: full
L1d cache:           32K
L1i cache:           32K
L2 cache:            256K
L3 cache:            8192K
NUMA node0 CPU(s):   0-3
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc cpuid aperfmperf pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm cpuid_fault epb invpcid_single pti fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts
```

`cat /proc/cpuinfo`

```yaml
â•­â”€root@gitlab /opt
â•°â”€# cat /proc/cpuinfo
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 60
model name      : Intel(R) Xeon(R) CPU E3-1271 v3 @ 3.60GHz
stepping        : 3
microcode       : 0x1c
cpu MHz         : 3591.683
cache size      : 8192 KB
physical id     : 0
siblings        : 1
core id         : 0
cpu cores       : 1
apicid          : 0
initial apicid  : 0
fpu             : yes
fpu_exception   : yes
cpuid level     : 13
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc cpuid aperfmperf pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm cpuid_fault epb invpcid_single pti fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts
bugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs
bogomips        : 7183.36
clflush size    : 64
cache_alignment : 64
address sizes   : 42 bits physical, 48 bits virtual
power management:
```

#### lshw

```bash
lshw - list hardware åˆ—å‡ºç¡¬ä»¶è®¾å¤‡
lshw is a small tool to extract detailed information on the hardware configuration of the machine. It  can report exact memory configuration, firmware version, mainboard configuration, CPU version and speed, cache configuration, bus speed, etc. on DMI-capable x86 or IA-64 systems and on some PowerPC machines  (PowerMac G4 is known to work).It  currently  supports  DMI (x86 and IA-64 only), OpenFirmware device tree (PowerPC only), PCI/AGP, CPUID (x86), IDE/ATA/ATAPI, PCMCIA (only tested on x86), SCSI and USB.
```

#### lsinitramfs

> lsinitramfs - list content of an initramfs image
>
> The  lsinitramfs  command  lists the content of given initramfs images. It allows one to quickly check the content of one (or multiple) specified initramfs files.

```bash
â•­â”€root@gitlab /opt
â•°â”€# lsinitramfs /boot/initrd.img-4.15.0-58-generic | head -n 10
.
usr
usr/share
usr/share/plymouth
usr/share/plymouth/themes
usr/share/plymouth/themes/details
usr/share/plymouth/themes/details/details.plymouth
usr/share/plymouth/themes/text.plymouth
usr/share/plymouth/themes/ubuntu-text
usr/share/plymouth/themes/ubuntu-text/ubuntu-text.plymouth.in
```

#### lsipc

> lsipc - show information on IPC facilities currently employed in the system
>
> lsipc  shows  information  on the inter-process communication facilities for which the calling process has read access.

```bash
â•­â”€root@gitlab /opt
â•°â”€# lsipc
RESOURCE DESCRIPTION                                     LIMIT USED  USE%
MSGMNI   Number of message queues                        32000    0 0.00%
MSGMAX   Max size of message (bytes)                      8192    -     -
MSGMNB   Default max size of queue (bytes)               16384    -     -
SHMMNI   Shared memory segments                           4096    1 0.02%
SHMALL   Shared memory pages                           4194304    0 0.00%
SHMMAX   Max size of shared memory segment (bytes) 17179869184    -     -
SHMMIN   Min size of shared memory segment (bytes)           1    -     -
SEMMNI   Number of semaphore identifiers                   262    0 0.00%
SEMMNS   Total number of semaphores                      32000    0 0.00%
SEMMSL   Max semaphores per semaphore set.                 250    -     -
SEMOPM   Max number of operations per semop(2)              32    -     -
SEMVMX   Semaphore max value                             32767    -     -
```

#### lslocks

> lslocks - list local system locks
>
> lslocks lists information about all the currently held file locks in a Linux system

```bash
â•­â”€root@gitlab /opt
â•°â”€# lslocks
COMMAND           PID  TYPE SIZE MODE  M START END PATH
cron              900 FLOCK   4B WRITE 0     0   0 /run/crond.pid
svlogd          53065 FLOCK   0B WRITE 0     0   0 /var/log/gitlab/redis/lock
runsv           54095 FLOCK   0B WRITE 0     0   0 /opt/gitlab/sv/sidekiq/supervise/lock
runsv           54095 FLOCK   0B WRITE 0     0   0 /opt/gitlab/sv/sidekiq/log/supervise/lock
```

#### lslogins

> lslogins - display information about known users in the system
>
> Examine the wtmp and btmp logs, /etc/shadow (if necessary) and /etc/passwd and output the desired data. The default action is to list info about all the users in the system.

```bash
â•­â”€root@gitlab /opt
â•°â”€# lslogins
  UID USER              PROC PWD-LOCK PWD-DENY LAST-LOGIN GECOS
	 0 root               211        0        0      06:58 root
	 1 daemon               1        0        1            daemon
	 2 bin                  0        0        1            bin
	 3 sys                  0        0        1            sys
	 4 sync                 0        0        1            sync
	 5 games                0        0        1            games
	 6 man                  0        0        1            man
	 7 lp                   0        0        1            lp
	 8 mail                 0        0        1            mail
	 9 news                 0        0        1            news
	10 uucp                 0        0        1            uucp
	13 proxy                0        0        1            proxy
	33 www-data             0        0        1            www-data
	34 backup               0        0        1            backup
	38 list                 0        0        1            Mailing List Manager
	39 irc                  0        0        1            ircd
	41 gnats                0        0        1            Gnats Bug-Reporting System (admin)
  100 systemd-network      1        0        1            systemd Network Management,,,
  101 systemd-resolve      1        0        1            systemd Resolver,,,
  102 syslog               1        0        1
  103 messagebus           1        0        1
  104 _apt                 0        0        1
  105 lxd                  0        0        1
  106 uuidd                0        0        1
  107 dnsmasq              0        0        1            dnsmasq,,,
  108 landscape            0        0        1
  109 pollinate            0        0        1
  110 sshd                 0        0        1
  995 gitlab-prometheus    4        0        1
  996 gitlab-psql         18        0        1
  997 gitlab-redis         2        0        1
  998 git                 16        0        1
  999 gitlab-www           5        0        1
 1000 ubuntu               0        0        0 2019-Aug28 ubuntu
65534 nobody               0        0        1            nobody
```

#### lsmem

> lsmem - list the ranges of available memory with their online status
>
> The  lsmem command lists the ranges of available memory with their online status. The listed memory blocks correspond to the memory block representation in sysfs. The command also shows the memory block  size  and the amount of memory in online and offline state.

```bash
â•­â”€root@gitlab /opt
â•°â”€# lsmem                                                                                                     127 â†µ
RANGE                                  SIZE  STATE REMOVABLE BLOCK
0x0000000000000000-0x0000000007ffffff  128M online        no     0
0x0000000008000000-0x000000000fffffff  128M online       yes     1
0x0000000010000000-0x000000001fffffff  256M online        no   2-3
0x0000000020000000-0x0000000027ffffff  128M online       yes     4
0x0000000028000000-0x0000000037ffffff  256M online        no   5-6
0x0000000038000000-0x000000003fffffff  128M online       yes     7
0x0000000040000000-0x000000006fffffff  768M online        no  8-13
0x0000000070000000-0x0000000077ffffff  128M online       yes    14
0x0000000078000000-0x00000000bfffffff  1.1G online        no 15-23
0x0000000100000000-0x000000013fffffff    1G online        no 32-39

Memory block size:       128M
Total online memory:       4G
Total offline memory:      0B
```

#### lsmod

> lsmod - Show the status of modules in the Linux Kernel

```bash
â•­â”€root@gitlab /opt
â•°â”€# lsmod
Module                  Size  Used by
tcp_diag               16384  0
inet_diag              24576  1 tcp_diag
joydev                 24576  0
input_leds             16384  0
vmw_balloon            20480  0
serio_raw              16384  0
vmw_vsock_vmci_transport    28672  1
vsock                  36864  2 vmw_vsock_vmci_transport
vmw_vmci               69632  2 vmw_balloon,vmw_vsock_vmci_transport
sch_fq_codel           20480  5
ib_iser                49152  0
rdma_cm                61440  1 ib_iser
iw_cm                  45056  1 rdma_cm
ib_cm                  53248  1 rdma_cm
ib_core               225280  4 rdma_cm,iw_cm,ib_iser,ib_cm
iscsi_tcp              20480  0
libiscsi_tcp           20480  1 iscsi_tcp
libiscsi               53248  3 libiscsi_tcp,iscsi_tcp,ib_iser
scsi_transport_iscsi    98304  3 iscsi_tcp,ib_iser,libiscsi
ip_tables              28672  0
x_tables               40960  1 ip_tables
autofs4                40960  2
btrfs                1130496  0
zstd_compress         163840  1 btrfs
raid10                 53248  0
raid456               143360  0
async_raid6_recov      20480  1 raid456
async_memcpy           16384  2 raid456,async_raid6_recov
async_pq               16384  2 raid456,async_raid6_recov
async_xor              16384  3 async_pq,raid456,async_raid6_recov
async_tx               16384  5 async_pq,async_memcpy,async_xor,raid456,async_raid6_recov
xor                    24576  2 async_xor,btrfs
raid6_pq              114688  4 async_pq,btrfs,raid456,async_raid6_recov
libcrc32c              16384  1 raid456
raid1                  40960  0
raid0                  20480  0
multipath              16384  0
linear                 16384  0
crct10dif_pclmul       16384  0
crc32_pclmul           16384  0
ghash_clmulni_intel    16384  0
pcbc                   16384  0
vmwgfx                274432  1
ttm                   106496  1 vmwgfx
drm_kms_helper        172032  1 vmwgfx
aesni_intel           188416  0
syscopyarea            16384  1 drm_kms_helper
aes_x86_64             20480  1 aesni_intel
sysfillrect            16384  1 drm_kms_helper
crypto_simd            16384  1 aesni_intel
sysimgblt              16384  1 drm_kms_helper
glue_helper            16384  1 aesni_intel
fb_sys_fops            16384  1 drm_kms_helper
cryptd                 24576  3 crypto_simd,ghash_clmulni_intel,aesni_intel
psmouse               147456  0
drm                   401408  4 vmwgfx,drm_kms_helper,ttm
mptspi                 24576  2
mptscsih               40960  1 mptspi
mptbase               102400  2 mptspi,mptscsih
ahci                   40960  0
libahci                32768  1 ahci
i2c_piix4              24576  0
vmxnet3                57344  0
scsi_transport_spi     32768  1 mptspi
pata_acpi              16384  0
```

#### lsns - list namespaces

lsns  lists  information  about all the currently accessible namespaces or about the given namespace.  The namespace identifier is an inode number.

```bash
â•­â”€root@gitlab /opt
â•°â”€# lsns
		  NS TYPE   NPROCS   PID USER             COMMAND
4026531835 cgroup    264     1 root             /lib/systemd/systemd --system --deserialize 39
4026531836 pid       264     1 root             /lib/systemd/systemd --system --deserialize 39
4026531837 user      264     1 root             /lib/systemd/systemd --system --deserialize 39
4026531838 uts       264     1 root             /lib/systemd/systemd --system --deserialize 39
4026531839 ipc       264     1 root             /lib/systemd/systemd --system --deserialize 39
4026531840 mnt       259     1 root             /lib/systemd/systemd --system --deserialize 39
4026531861 mnt         1    31 root             kdevtmpfs
4026531993 net       264     1 root             /lib/systemd/systemd --system --deserialize 39
4026532531 mnt         1 37609 root             /lib/systemd/systemd-udevd
4026532556 mnt         1 42954 systemd-timesync /lib/systemd/systemd-timesyncd
4026532557 mnt         1 42900 systemd-network  /lib/systemd/systemd-networkd
4026532603 mnt         1 42924 systemd-resolve  /lib/systemd/systemd-resolved
```

#### lsof - list open files

#### lspci - list all PCI devices

> lspci is a utility for displaying information about PCI buses in the system and devices connected to them.

```bash
â•­â”€root@gitlab /opt
â•°â”€# lspci
00:00.0 Host bridge: Intel Corporation 440BX/ZX/DX - 82443BX/ZX/DX Host bridge (rev 01)
00:01.0 PCI bridge: Intel Corporation 440BX/ZX/DX - 82443BX/ZX/DX AGP bridge (rev 01)
00:07.0 ISA bridge: Intel Corporation 82371AB/EB/MB PIIX4 ISA (rev 08)
00:07.1 IDE interface: Intel Corporation 82371AB/EB/MB PIIX4 IDE (rev 01)
00:07.3 Bridge: Intel Corporation 82371AB/EB/MB PIIX4 ACPI (rev 08)
00:07.7 System peripheral: VMware Virtual Machine Communication Interface (rev 10)
00:0f.0 VGA compatible controller: VMware SVGA II Adapter
00:10.0 SCSI storage controller: LSI Logic / Symbios Logic 53c1030 PCI-X Fusion-MPT Dual Ultra320 SCSI (rev 01)
00:11.0 PCI bridge: VMware PCI bridge (rev 02)
```

#### lspgpot

> lspgpot - extracts the ownertrust values from PGP keyrings and list them in GnuPG ownertrust format.

```shell
â•­â”€root@sg-02 /home/ubuntu
â•°â”€# lshw
sg-02
	 description: Computer
	 product: HVM domU
	 vendor: Xen
	 version: 4.2.amazon
	 serial: ec2c5773-d127-c5a4-60a3-221becf4e6ae
	 width: 64 bits
	 capabilities: smbios-2.7 dmi-2.7 vsyscall32
	 configuration: boot=normal uuid=73572CEC-27D1-A4C5-60A3-221BECF4E6AE
  *-core
		 description: Motherboard
		 physical id: 0
	  *-firmware
			 description: BIOS
			 vendor: Xen
			 physical id: 0
			 version: 4.2.amazon
			 date: 08/24/2006
			 size: 96KiB
			 capabilities: pci edd
	  *-cpu
			 description: CPU
			 product: Intel(R) Xeon(R) CPU E5-2676 v3 @ 2.40GHz
			 vendor: Intel Corp.
			 physical id: 401
			 bus info: cpu@0
			 slot: CPU 1
			 size: 2400MHz
			 capacity: 2400MHz
			 width: 64 bits
			 capabilities: fpu fpu_exception wp vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx rdtscp x86-64 constant_tsc rep_good nopl xtopology cpuid pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm cpuid_fault invpcid_single pti fsgsbase bmi1 avx2 smep bmi2 erms invpcid xsaveopt
	  *-memory
			 description: System Memory
			 physical id: 1000
			 size: 1GiB
			 capacity: 1GiB
			 capabilities: ecc
			 configuration: errordetection=multi-bit-ecc
		  *-bank
				 description: DIMM RAM
				 physical id: 0
				 slot: DIMM 0
				 size: 1GiB
				 width: 64 bits
	  *-pci
			 description: Host bridge
			 product: 440FX - 82441FX PMC [Natoma]
			 vendor: Intel Corporation
			 physical id: 100
			 bus info: pci@0000:00:00.0
			 version: 02
			 width: 32 bits
			 clock: 33MHz
		  *-isa
				 description: ISA bridge
				 product: 82371SB PIIX3 ISA [Natoma/Triton II]
				 vendor: Intel Corporation
				 physical id: 1
				 bus info: pci@0000:00:01.0
				 version: 00
				 width: 32 bits
				 clock: 33MHz
				 capabilities: isa bus_master
				 configuration: latency=0
		  *-ide
				 description: IDE interface
				 product: 82371SB PIIX3 IDE [Natoma/Triton II]
				 vendor: Intel Corporation
				 physical id: 1.1
				 bus info: pci@0000:00:01.1
				 version: 00
				 width: 32 bits
				 clock: 33MHz
				 capabilities: ide bus_master
				 configuration: driver=ata_piix latency=64
				 resources: irq:0 ioport:1f0(size=8) ioport:3f6 ioport:170(size=8) ioport:376 ioport:c100(size=16)
		  *-bridge UNCLAIMED
				 description: Bridge
				 product: 82371AB/EB/MB PIIX4 ACPI
				 vendor: Intel Corporation
				 physical id: 1.3
				 bus info: pci@0000:00:01.3
				 version: 01
				 width: 32 bits
				 clock: 33MHz
				 capabilities: bridge bus_master
				 configuration: latency=0
		  *-display UNCLAIMED
				 description: VGA compatible controller
				 product: GD 5446
				 vendor: Cirrus Logic
				 physical id: 2
				 bus info: pci@0000:00:02.0
				 version: 00
				 width: 32 bits
				 clock: 33MHz
				 capabilities: vga_controller bus_master
				 configuration: latency=0
				 resources: memory:f0000000-f1ffffff memory:f3000000-f3000fff memory:c0000-dffff
		  *-generic
				 description: Unassigned class
				 product: Xen Platform Device
				 vendor: XenSource, Inc.
				 physical id: 3
				 bus info: pci@0000:00:03.0
				 version: 01
				 width: 32 bits
				 clock: 33MHz
				 capabilities: bus_master
				 configuration: driver=xen-platform-pci latency=0
				 resources: irq:28 ioport:c000(size=256) memory:f2000000-f2ffffff
  *-network:0
		 description: Ethernet interface
		 physical id: 1
		 logical name: eth0
		 serial: 02:24:d2:49:f2:94
		 capabilities: ethernet physical
		 configuration: broadcast=yes driver=vif ip=172.26.17.53 link=yes multicast=yes
  *-network:1
		 description: Ethernet interface
		 physical id: 2
		 logical name: docker0
		 serial: 02:42:37:cf:cf:aa
		 capabilities: ethernet physical
		 configuration: broadcast=yes driver=bridge driverversion=2.3 firmware=N/A ip=172.17.0.1 link=no multicast=yes
â•­â”€root@sg-02 /home/ubuntu
â•°â”€#
```

### proc

ç¡®åˆ‡æ¥è¯´è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œè€Œæ˜¯ Linux çš„å†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬äº†è§£ä¸€äº›ç³»ç»Ÿä¿¡æ¯ï¼Œæ–¹ä¾¿æ’æŸ¥ä¸€äº›æ•…éšœç­‰ã€‚

#### CPU

`cat /proc/cpuinfo` å’Œ `lscpu`

```yaml
[root@k8s-master-01 ~]# cat /proc/cpuinfo
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 60
model name      : Intel(R) Xeon(R) CPU E3-1271 v3 @ 3.60GHz
stepping        : 3
microcode       : 0x1c
cpu MHz         : 3591.683
cache size      : 8192 KB
physical id     : 0
siblings        : 1
core id         : 0
cpu cores       : 1
apicid          : 0
initial apicid  : 0
fpu             : yes
fpu_exception   : yes
cpuid level     : 13
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm epb fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid xsaveopt dtherm ida arat pln pts
bogomips        : 7183.36
clflush size    : 64
cache_alignment : 64
address sizes   : 42 bits physical, 48 bits virtual
power management:
```

#### RAM

```yaml
[root@k8s-master-01 proc]# cat meminfo
MemTotal:        3863636 kB
MemFree:          247016 kB
MemAvailable:    2096628 kB
Buffers:           85612 kB
Cached:          1952072 kB
SwapCached:            0 kB
Active:          2250028 kB
Inactive:        1003588 kB
Active(anon):    1224120 kB
Inactive(anon):    21344 kB
Active(file):    1025908 kB
Inactive(file):   982244 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:               128 kB
Writeback:             0 kB
AnonPages:       1215816 kB
Mapped:           196080 kB
Shmem:             29532 kB
Slab:             222544 kB
SReclaimable:      92156 kB
SUnreclaim:       130388 kB
KernelStack:       15904 kB
PageTables:        13024 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:     1931816 kB
Committed_AS:    7402668 kB
VmallocTotal:   34359738367 kB
VmallocUsed:      187276 kB
VmallocChunk:   34359310332 kB
HardwareCorrupted:     0 kB
AnonHugePages:    264192 kB
CmaTotal:              0 kB
CmaFree:               0 kB
HugePages_Total:       0
HugePages_Free:        0
HugePages_Rsvd:        0
HugePages_Surp:        0
Hugepagesize:       2048 kB
DirectMap4k:      206720 kB
DirectMap2M:     3987456 kB
DirectMap1G:     2097152 kB
```

#### net

- arp

```shell
â•­â”€root@k8s-node-3 /proc/net
â•°â”€# cat arp
IP address       HW type     Flags       HW address            Mask     Device
169.254.169.254  0x1         0x0         00:00:00:00:00:00     *        ens160
100.78.36.67     0x1         0x2         ee:25:17:a5:e9:3b     *        cali35f7ecfd8a4
10.20.172.212    0x1         0x2         00:0c:29:16:f5:1f     *        ens160
100.78.36.65     0x1         0x2         d6:80:af:8a:22:c7     *        calid838acfbeda
10.20.172.1      0x1         0x2         00:00:5e:00:01:3a     *        ens160
10.20.172.102    0x1         0x2         00:21:91:53:e8:a3     *        ens160
10.20.172.254    0x1         0x2         5c:dd:70:05:e8:53     *        ens160
10.20.172.106    0x1         0x2         98:90:96:d0:86:8a     *        ens160
```

- route

```shell
â•­â”€root@k8s-node-3 ~
â•°â”€# cat /proc/net/fib_trie
Main:
  +-- 0.0.0.0/0 3 1 5
	  +-- 0.0.0.0/4 2 0 2
		  |-- 0.0.0.0
			  /0 universe UNICAST
		  +-- 10.0.0.0/9 2 0 2
			  +-- 10.20.172.0/24 2 1 2
				  |-- 10.20.172.0
					  /32 link BROADCAST
					  /24 link UNICAST
				  +-- 10.20.172.192/26 2 0 2
					  |-- 10.20.172.211
						  /32 host LOCAL
					  |-- 10.20.172.255
						  /32 link BROADCAST
			  +-- 10.96.0.0/12 4 1 7
				  +-- 10.96.0.0/16 2 0 1
					  +-- 10.96.0.0/28 2 0 2
						  |-- 10.96.0.1
							  /32 host LOCAL
						  |-- 10.96.0.10
							  /32 host LOCAL
					  |-- 10.96.94.140
						  /32 host LOCAL
					  |-- 10.96.130.114
						  /32 host LOCAL
				  |-- 10.99.89.188
					  /32 host LOCAL
				  |-- 10.101.71.131
					  /32 host LOCAL
				  |-- 10.104.241.211
					  /32 host LOCAL
				  |-- 10.107.246.53
					  /32 host LOCAL
				  |-- 10.108.171.54
					  /32 host LOCAL
				  |-- 10.109.20.145
					  /32 host LOCAL
				  |-- 10.110.206.28
					  /32 host LOCAL
				  |-- 10.111.25.53
					  /32 host LOCAL
	  +-- 96.0.0.0/3 2 0 2
		  +-- 100.64.0.0/10 3 0 3
			  +-- 100.78.36.64/26 3 0 6
				  +-- 100.78.36.64/30 2 0 0
					  |-- 100.78.36.64
						  /32 host LOCAL
						  /32 link BROADCAST
						  /26 universe BLACKHOLE
					  |-- 100.78.36.65
						  /32 link UNICAST
					  |-- 100.78.36.66
						  /32 link UNICAST
					  |-- 100.78.36.67
						  /32 link UNICAST
				  |-- 100.78.36.105
					  /32 link UNICAST
			  |-- 100.87.114.192
				  /26 universe UNICAST
			  |-- 100.107.127.64
				  /26 universe UNICAST
			  |-- 100.112.151.128
				  /26 universe UNICAST
			  |-- 100.123.190.192
				  /26 universe UNICAST
		  +-- 127.0.0.0/8 2 0 2
			  +-- 127.0.0.0/31 1 0 0
				  |-- 127.0.0.0
					  /32 link BROADCAST
					  /8 host LOCAL
				  |-- 127.0.0.1
					  /32 host LOCAL
			  |-- 127.255.255.255
				  /32 link BROADCAST
	  +-- 168.0.0.0/5 2 0 2
		  |-- 169.254.0.0
			  /16 link UNICAST
		  +-- 172.16.0.0/14 3 0 6
			  +-- 172.17.0.0/31 1 0 0
				  |-- 172.17.0.0
					  /32 link BROADCAST
					  /16 link UNICAST
				  |-- 172.17.0.1
					  /32 host LOCAL
			  |-- 172.17.255.255
				  /32 link BROADCAST
```

- nf_conntrack

```shell
â•­â”€root@k8s-node-3 /proc/net
â•°â”€# cat nf_conntrack | head -n 4
ipv4     2 tcp      6 102 SYN_SENT src=10.20.172.211 dst=10.10.107.214 sport=42562 dport=179 [UNREPLIED] src=10.10.107.214 dst=10.20.172.211 sport=179 dport=42562 mark=0 secctx=system_u:object_r:unlabeled_t:s0 zone=0 use=2
ipv4     2 tcp      6 79 SYN_SENT src=10.20.172.211 dst=10.10.107.214 sport=60579 dport=179 [UNREPLIED] src=10.10.107.214 dst=10.20.172.211 sport=179 dport=60579 mark=0 secctx=system_u:object_r:unlabeled_t:s0 zone=0 use=2
ipv4     2 tcp      6 86366 ESTABLISHED src=10.20.172.211 dst=10.10.107.121 sport=58589 dport=179 src=10.10.107.121 dst=10.20.172.211 sport=179 dport=58589 [ASSURED] mark=0 secctx=system_u:object_r:unlabeled_t:s0 zone=0 use=2
ipv4     2 tcp      6 62 SYN_SENT src=10.20.172.211 dst=10.10.107.214 sport=37531 dport=179 [UNREPLIED] src=10.10.107.214 dst=10.20.172.211 sport=179 dport=37531 mark=0 secctx=system_u:object_r:unlabeled_t:s0 zone=0 use=2
```

#### kernel

```shell
[root@k8s-master-01 proc]# uname -a
Linux k8s-master-01 3.10.0-862.el7.x86_64 #1 SMP Fri Apr 20 16:44:24 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
[root@k8s-master-01 proc]# cat version
Linux version 3.10.0-862.el7.x86_64 (builder@kbuilder.dev.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-28) (GCC) ) #1 SMP Fri Apr 20 16:44:24 UTC 2018
```

### ç½‘ç»œ

#### nc netcat

#### nmap

### æµ‹è¯•

#### [fio](https://github.com/axboe/fio)

- install

```shell
# RHEL/CentOS
yum install fio

# Debian/Ubuntu
apt install fio
```

- usage

```ini
filename=/tmp        # æµ‹è¯•æ–‡ä»¶åç§°ï¼Œé€šå¸¸é€‰æ‹©éœ€è¦æµ‹è¯•çš„ç›˜çš„ data ç›®å½•
direct=1             # æµ‹è¯•è¿‡ç¨‹ç»•è¿‡æœºå™¨è‡ªå¸¦çš„ bufferã€‚ä½¿æµ‹è¯•ç»“æœæ›´çœŸå®
rw=randwrite         # æµ‹è¯•éšæœºå†™çš„ I/O
rw=randrw            # æµ‹è¯•éšæœºå†™å’Œè¯»çš„ I/O
bs=16k               # å•æ¬¡ io çš„å—æ–‡ä»¶å¤§å°ä¸º 16k
bsrange=512-2048     # åŒä¸Šï¼Œæå®šæ•°æ®å—çš„å¤§å°èŒƒå›´
size=5G              # æœ¬æ¬¡çš„æµ‹è¯•æ–‡ä»¶å¤§å°ä¸º 5gï¼Œä»¥æ¯æ¬¡ 4k çš„ io è¿›è¡Œæµ‹è¯•
numjobs=30           # æœ¬æ¬¡çš„æµ‹è¯•çº¿ç¨‹ä¸º 30 ä¸ª
runtime=1000         # æµ‹è¯•æ—¶é—´ 1000 ç§’ï¼Œå¦‚æœä¸å†™åˆ™ä¸€ç›´å°† 5g æ–‡ä»¶åˆ† 4k æ¯æ¬¡å†™å®Œä¸ºæ­¢
ioengine=psync       #io å¼•æ“ä½¿ç”¨ psync æ–¹å¼
rwmixwrite=30        # åœ¨æ··åˆè¯»å†™çš„æ¨¡å¼ä¸‹ï¼Œå†™å  30%
group_reporting      # å…³äºæ˜¾ç¤ºç»“æœçš„ï¼Œæ±‡æ€»æ¯ä¸ªè¿›ç¨‹çš„ä¿¡æ¯

lockmem=1G           # åªä½¿ç”¨ 1g å†…å­˜è¿›è¡Œæµ‹è¯•s
zero_buffers         # ç”¨ 0 åˆå§‹åŒ–ç³»ç»Ÿ buffer
nrfiles=8            # æ¯ä¸ªè¿›ç¨‹ç”Ÿæˆæ–‡ä»¶çš„æ•°é‡
```

`æ³¨æ„ï¼š` åªè¦ä¸æ˜¯æµ‹è¯•ç©ºç›˜ï¼Œ`filename` å‚æ•°åƒä¸‡ä¸è¦ä½¿ç”¨ç±»ä¼¼ `/dev/sda` è¿™æ— å¼‚äºåˆ åº“è·‘è·¯ğŸ˜‚ã€‚æ‰€ä»¥æ¨èä½¿ç”¨è·¯å¾„è€Œä¸æ˜¯è®¾å¤‡ã€‚

- output example

```shell
â•­â”€root@nfs ~
â•°â”€# fio -filename=/tmp/test.file -direct=1 -iodepth 1 -thread -rw=randrw -rwmixread=70 -ioengine=psync -bs=16k -size=1G -numjobs=30 -runtime=100 -group_reporting -name=mytest1
mytest1: (g=0): rw=randrw, bs=(R) 16.0KiB-16.0KiB, (W) 16.0KiB-16.0KiB, (T) 16.0KiB-16.0KiB, ioengine=psync, iodepth=1
...
fio-3.7
Starting 30 threads
mytest1: Laying out IO file (1 file / 1024MiB)
Jobs: 30 (f=30): [m(30)][100.0%][r=1265KiB/s,w=560KiB/s][r=79,w=35 IOPS][eta 00m:00s]
mytest1: (groupid=0, jobs=30): err= 0: pid=45930: Mon Apr 27 23:09:21 2020
	read: IOPS=71, BW=1149KiB/s (1177kB/s)(113MiB/100321msec)
	 clat (usec): min=349, max=999812, avg=292473.60, stdev=188905.70
	  lat (usec): min=349, max=999813, avg=292473.83, stdev=188905.69
	 clat percentiles (msec):
	  |  1.00th=[    5],  5.00th=[    8], 10.00th=[   11], 20.00th=[   24],
	  | 30.00th=[  247], 40.00th=[  313], 50.00th=[  342], 60.00th=[  372],
	  | 70.00th=[  401], 80.00th=[  430], 90.00th=[  481], 95.00th=[  542],
	  | 99.00th=[  751], 99.50th=[  818], 99.90th=[  894], 99.95th=[  936],
	  | 99.99th=[ 1003]
	bw (  KiB/s): min=   31, max=   96, per=3.53%, avg=40.55, stdev=14.30, samples=5661
	iops        : min=    1, max=    6, avg= 2.48, stdev= 0.93, samples=5661
  write: IOPS=30, BW=483KiB/s (494kB/s)(47.3MiB/100321msec)
	 clat (msec): min=2, max=937, avg=297.02, stdev=194.75
	  lat (msec): min=2, max=937, avg=297.02, stdev=194.75
	 clat percentiles (msec):
	  |  1.00th=[    5],  5.00th=[    9], 10.00th=[   11], 20.00th=[   16],
	  | 30.00th=[  266], 40.00th=[  326], 50.00th=[  355], 60.00th=[  380],
	  | 70.00th=[  405], 80.00th=[  435], 90.00th=[  481], 95.00th=[  550],
	  | 99.00th=[  760], 99.50th=[  810], 99.90th=[  902], 99.95th=[  927],
	  | 99.99th=[  936]
	bw (  KiB/s): min=   31, max=  256, per=9.65%, avg=46.52, stdev=25.43, samples=2071
	iops        : min=    1, max=   16, avg= 2.85, stdev= 1.61, samples=2071
  lat (usec)   : 500=0.02%, 750=0.02%
  lat (msec)   : 4=0.28%, 10=8.53%, 20=10.86%, 50=6.42%, 100=0.90%
  lat (msec)   : 250=2.90%, 500=62.21%, 750=6.79%, 1000=1.06%
  cpu          : usr=0.00%, sys=0.01%, ctx=19413, majf=0, minf=7
  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
	  submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
	  complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
	  issued rwts: total=7204,3026,0,0 short=0,0,0,0 dropped=0,0,0,0
	  latency   : target=0, window=0, percentile=100.00%, depth=1

Run status group 0 (all jobs):
	READ: bw=1149KiB/s (1177kB/s), 1149KiB/s-1149KiB/s (1177kB/s-1177kB/s), io=113MiB (118MB), run=100321-100321msec
  WRITE: bw=483KiB/s (494kB/s), 483KiB/s-483KiB/s (494kB/s-494kB/s), io=47.3MiB (49.6MB), run=100321-100321msec

Disk stats (read/write):
	 dm-0: ios=7750/3320, merge=0/0, ticks=200950/123253, in_queue=324237, util=99.83%, aggrios=7765/3135, aggrmerge=0/192, aggrticks=201237/111717, aggrin_queue=312951, aggrutil=99.81%
  sda: ios=7765/3135, merge=0/192, ticks=201237/111717, in_queue=312951, util=99.81%
```

#### qperf

- install

```shell
yum install qperf
apt install qperf
```

- usage

```shell
â•­â”€root@debian /opt/trojan
â•°â”€# qperf --help examples
In these examples, we first run qperf on a node called myserver in server
mode by invoking it with no arguments.  In all the subsequent examples, we
run qperf on another node and connect to the server which we assume has a
hostname of myserver.
	 * To run a TCP bandwidth and latency test:
		  qperf myserver tcp_bw tcp_lat
	 * To run a SDP bandwidth test for 10 seconds:
		  qperf myserver -t 10 sdp_bw
	 * To run a UDP latency test and then cause the server to terminate:
		  qperf myserver udp_lat quit
	 * To measure the RDMA UD latency and bandwidth:
		  qperf myserver ud_lat ud_bw
	 * To measure RDMA UC bi-directional bandwidth:
		  qperf myserver rc_bi_bw
	 * To get a range of TCP latencies with a message size from 1 to 64K
		  qperf myserver -oo msg_size:1:64K:*2 -vu tcp_lat
```

- output example

```shell
root@debian-node-02-656868cc46-72lc9:/# qperf  -t 30 100.107.127.100 -v tcp_bw udp_bw tcp_lat udp_lat conf
tcp_bw:
	 bw              =  3.24 GB/sec
	 msg_rate        =  49.4 K/sec
	 time            =    30 sec
	 send_cost       =   542 ms/GB
	 recv_cost       =   542 ms/GB
	 send_cpus_used  =   176 % cpus
	 recv_cpus_used  =   176 % cpus
udp_bw:
	 send_bw         =  2.62 GB/sec
	 recv_bw         =  2.37 GB/sec
	 msg_rate        =  72.3 K/sec
	 time            =    30 sec
	 send_cost       =   542 ms/GB
	 recv_cost       =   598 ms/GB
	 send_cpus_used  =   142 % cpus
	 recv_cpus_used  =   142 % cpus
tcp_lat:
	 latency        =  17.3 us
	 msg_rate       =  57.7 K/sec
	 time           =    30 sec
	 loc_cpus_used  =   110 % cpus
	 rem_cpus_used  =   110 % cpus
udp_lat:
	 latency        =  15.4 us
	 msg_rate       =  64.8 K/sec
	 time           =    30 sec
	 loc_cpus_used  =   111 % cpus
	 rem_cpus_used  =   111 % cpus
conf:
	 loc_node   =  debian-node-02-656868cc46-72lc9
	 loc_cpu    =  8 Cores: Intel Xeon E3-1271 v3 @ 3.60GHz
	 loc_os     =  Linux 3.10.0-862.el7.x86_64
	 loc_qperf  =  0.4.11
	 rem_node   =  debian-node-02-656868cc46-xftvq
	 rem_cpu    =  8 Cores: Intel Xeon E3-1271 v3 @ 3.60GHz
	 rem_os     =  Linux 3.10.0-862.el7.x86_64
	 rem_qperf  =  0.4.11
```

#### iperf

- install

- usage

- output example

#### [wrk](https://github.com/wg/wrk/)

- install

```shell
git clone https://github.com/wg/wrk.git --depth=1
cd wrk
make
```

- usage

```shell
./wrk
Usage: wrk <options> <url>
  Options:
	 -c, --connections <N>  Connections to keep open éœ€è¦æ¨¡æ‹Ÿçš„ä¸ªå¹¶å‘è¯·æ±‚è¿æ¥æ•°é‡
	 -d, --duration    <T>  Duration of test æµ‹è¯•çš„æµ‹è¯•æ—¶é•¿
	 -t, --threads     <N>  Number of threads to use å¹¶å‘çº¿ç¨‹æ•°é‡
	 -s, --script      <S>  Load Lua script file  æŒ‡å®š Lua è„šæœ¬çš„è·¯å¾„
	 -H, --header      <H>  Add header to request æŒ‡å®šè¯·æ±‚å¸¦çš„ Header å‚æ•°
		  --latency          Print latency statistics æ˜¯å¦æ‰“å°è¯·æ±‚å»¶è¿Ÿç»Ÿè®¡
		  --timeout     <T>  Socket/request timeout è®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´

```

- output example

```shell
# å¯¹ 10.20.172.196 nginx æœåŠ¡å™¨è¿›è¡Œæµ‹è¯•
â•­â”€root@test ~/wrk â€¹masterâ€º
â•°â”€# ./wrk -t100 -c512 -d30s http://10.20.172.196
Running 30s test @ http://10.20.172.196
  100 threads and 512 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
	 Latency    44.71ms  108.75ms   1.99s    89.05%
	 Req/Sec   369.78    207.57     1.68k    71.50%
  987158 requests in 30.10s, 840.66MB read
  Socket errors: connect 0, read 0, write 0, timeout 22
Requests/sec:  32797.65
Transfer/sec:     27.93MB
# æµ‹è¯•ç»“æœï¼ŒåŸºæœ¬èƒ½è¾¾åˆ° 3W+ çš„ QPS çš„æ€§èƒ½
```

#### httperf

- install

- usage

- output example

```shell
â•­â”€root@ubuntu-238 ~
â•°â”€# httperf --server 10.20.172.196 --port 80 --num-conns 100 --rate 10 --timeout 1
httperf --timeout=1 --client=0/1 --server=10.20.172.196 --port=80 --uri=/ --rate=10 --send-buffer=4096 --recv-buffer=16384 --num-conns=100 --num-calls=1
httperf: warning: open file limit > FD_SETSIZE; limiting max. # of open files to FD_SETSIZE
Maximum connect burst length: 1
# å“åº”é€Ÿç‡
Total: connections 100 requests 100 replies 100 test-duration 9.900 s
Connection rate: 10.1 conn/s (99.0 ms/conn, <=1 concurrent connections)
Connection time [ms]: min 0.1 avg 0.1 max 0.2 median 0.5 stddev 0.0
Connection time [ms]: connect 0.0
Connection length [replies/conn]: 1.000
Request rate: 10.1 req/s (99.0 ms/req)
Request size [B]: 66.0
# æœåŠ¡å™¨ä»è¯·æ±‚ä¸­æ¥æ”¶åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹ï¼Œåˆ°è¿æ¥æ”¶åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚æ‰€æ¶ˆè€—çš„æ—¶é—´
Reply rate [replies/s]: min 10.0 avg 10.0 max 10.0 stddev 0.0 (1 samples)
Reply time [ms]: response 0.1 transfer 0.0
# ç»Ÿè®¡æ¯ä¸ªå›å¤çš„å¤§å°ï¼Œæ¯ä¸ªç»´åº¦çš„å•ä½éƒ½æ˜¯å­—èŠ‚(bytes),ä¸”éƒ½æ˜¯å¹³å‡æ•°
Reply size [B]: header 244.0 content 649.0 footer 0.0 (total 893.0)
Reply status: 1xx=0 2xx=100 3xx=0 4xx=0 5xx=0
# å®¢æˆ·ç«¯CPUä½¿ç”¨ç‡çš„ç»Ÿè®¡ï¼ŒUserç”¨æˆ·æ¨¡å¼ï¼ŒSystemæ¨¡å¼
CPU time [s]: user 3.85 system 6.05 (user 38.9% system 61.1% total 100.0%)
# ç½‘ç»œçš„ååé‡
Net I/O: 9.5 KB/s (0.1*10^6 bps)
# å‘ç”Ÿé”™è¯¯çš„æ€»æ•°,å®¢æˆ·ç«¯è¶…æ—¶è®¡æ•°ï¼Œæ¯æ¬¡ä»ç”Ÿæˆè¯·æ±‚å¼€å§‹ï¼Œå¦‚æœæ²¡æœ‰å“åº”å³è¶…æ—¶,
# TCPè¿æ¥å¤±è´¥
Errors: total 0 client-timo 0 socket-timo 0 connrefused 0 connreset 0
Errors: fd-unavail 0 addrunavail 0 ftab-full 0 other 0
```

#### [ab]()

- install

- usage

- output example

```shell
â•­â”€root@test ~
â•°â”€# ab -n 1000 -c 1000 http://10.20.172.196/
This is ApacheBench, Version 2.3 <$Revision: 1430300 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/
Benchmarking 10.20.172.196 (be patient)
Completed 100 requests
Completed 200 requests
Completed 300 requests
Completed 400 requests
Completed 500 requests
Completed 600 requests
Completed 700 requests
Completed 800 requests
Completed 900 requests
Completed 1000 requests
Finished 1000 requests
Server Software:        nginx/1.15.8.1
Server Hostname:        10.20.172.196
Server Port:            80
Document Path:          /
Document Length:        649 bytes
Concurrency Level:      1000
Time taken for tests:   0.107 seconds
Complete requests:      1000
Failed requests:        0
Write errors:           0
Total transferred:      888000 bytes
HTML transferred:       649000 bytes
Requests per second:    9313.50 [#/sec] (mean)
Time per request:       107.371 [ms] (mean)
Time per request:       0.107 [ms] (mean, across all concurrent requests)
Transfer rate:          8076.55 [Kbytes/sec] received

Connection Times (ms)
				  min  mean[+/-sd] median   max
Connect:        0   29   8.1     29      42
Processing:    17   36  14.3     45      51
Waiting:        0   35  14.3     44      50
Total:         42   65   9.0     64      87

Percentage of the requests served within a certain time (ms)
  50%     64
  66%     69
  75%     71
  80%     73
  90%     78
  95%     81
  98%     84
  99%     86
 100%     87 (longest request)
```

#### stress

> [Stress/Stress-NG](https://www.tecmint.com/linux-cpu-load-stress-test-with-stress-ng-tool/)æ˜¯Linuxä¸‹ä¸¤ä¸ªå¸¸ç”¨çš„ç³»ç»Ÿçº§å‹åŠ›æµ‹è¯•å·¥å…·ï¼Œ**stress**å‘½ä»¤ç®€å•æ˜“ç”¨ï¼Œ**stress-ng**æ˜¯stressçš„å‡çº§ç‰ˆï¼Œæ”¯æŒ**æ•°ç™¾ä¸ªå‚æ•°å®šåˆ¶å„ç§å‹CPUã€å†…å­˜ã€IOã€ç½‘ç»œ**çš„å§¿åŠ¿ã€‚åœ¨ç³»ç»Ÿè¿‡è½½çš„åœºæ™¯ä¸‹ï¼Œåº”ç”¨æœåŠ¡å¯èƒ½ä¼šå‡ºç°æ„æƒ³ä¸åˆ°çš„é”™è¯¯æˆ–å¼‚å¸¸ï¼Œåœ¨æµ‹è¯•**è´Ÿè½½å‡è¡¡å’Œç†”æ–­é™çº§**æ—¶éå¸¸æœ‰ç”¨ã€‚è¿™é‡Œåªåˆ—ä¸¾äº†å‡ ä¸ªå¸¸ç”¨çš„å‘½ä»¤ï¼Œè¯¦ç»†ä½¿ç”¨å‚è€ƒâ€stress-ng â€“helpâ€æˆ–â€man stress-ngâ€ã€‚å¦å¤–ï¼Œè¿™äº›â€œçƒ¤æœºâ€å‘½ä»¤æ¥æµ‹è¯•æœåŠ¡å™¨æ€§èƒ½ä¹Ÿæ˜¯ä¸é”™çš„ã€‚

- install

```shell
# RHRL/CentOS
yum install epel-release
yum install stress stress-ng

# Debian/Ubuntu
apt install stress stress-ng

# stress-ng åŸºæœ¬ç”¨æ³•ä¸stresså®Œå…¨å…¼å®¹ï¼Œä½†æœ‰æ›´å¤šçš„å‚æ•°å¯é€‰ï¼Œå¹¶ä¸”å¯ä»¥æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
```

- usage

```shell
# åœ¨ä¸¤ä¸ªCPUæ ¸å¿ƒä¸Šè·‘å¼€æ–¹è¿ç®—ï¼Œå¹¶ä¸”å¯åŠ¨ä¸€ä¸ªä¸æ–­åˆ†é…é‡Šæ”¾1Gå†…å­˜çš„çº¿ç¨‹ï¼Œè¿è¡Œ10ç§’ååœæ­¢
stress --cpu 2 --vm 1 --vm-bytes 1G  -v --timeout 10

# å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¸æ–­æ‰§è¡Œsyncç³»ç»Ÿè°ƒç”¨å›å†™ç£ç›˜ç¼“å­˜ï¼Œå¹¶ä¸”å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¸åœåœ°å†™å…¥åˆ é™¤512MBæ•°æ®ï¼Œè¿è¡Œ10ç§’åœæ­¢
stress --io 1 --hdd 1 --hdd-bytes 512M -v --timeout 10

# --sock å¯ä»¥æ¨¡æ‹Ÿå¤§é‡çš„socketè¿æ¥æ–­å¼€ä»¥åŠæ•°æ®çš„å‘é€æ¥æ”¶ç­‰ç­‰
stress-ng --sock 2 -v --timeout 10 --metrics-brief
```

- output example

```shell
â•­â”€root@debian /bashtop  â€¹masterâ€º
â•°â”€# stress --cpu 4 --vm 1 --vm-bytes 1G  -v --timeout 3
stress: info: [18174] dispatching hogs: 4 cpu, 0 io, 1 vm, 0 hdd
stress: dbug: [18174] using backoff sleep of 3000us
stress: dbug: [18174] setting timeout to 3s
stress: dbug: [18174] --> hogcpu worker 1 [18179] forked
stress: dbug: [18176] allocating 1073741824 bytes ...
stress: dbug: [18176] allocating 1073741824 bytes ...
stress: dbug: [18176] touching bytes in strides of 4096 bytes ...
stress: dbug: [18174] <-- worker 18175 signalled normally
stress: dbug: [18174] <-- worker 18177 signalled normally
stress: dbug: [18174] <-- worker 18178 signalled normally
stress: dbug: [18174] <-- worker 18179 signalled normally
stress: dbug: [18174] <-- worker 18176 signalled normally
stress: info: [18174] successful run completed in 3s
```

![image-20200506154459952](img/image-20200506154459952.png)


### å°å·¥å…·

### é•œåƒæº

## å‘è¡Œç‰ˆ



### pxder

ä¸‹ç­ä¹‹åå›åˆ°å°çªä¹‹åå°±å¼€å§‹ä¸€å¤©ä¸­æœ€æœ€æ„‰æ‚¦çš„æ—¶åˆ»ï¼Œåœ¨ pixiv.net ä¸Šåˆ·å›¾ã€‚æ”¶è—å–œæ¬¢çš„~~è€å©†~~æ’ç”»ã€‚ä¸ºäº†ç®¡ç†å’Œä¸‹è½½è‡ªå·±æ”¶è—çš„æ’ç”»ä½œå“ï¼Œå½“ç„¶è¿˜æ˜¯é€‰æ‹©é£Ÿç”¨å·¥å…·æ¥ä¸‹è½½å•¦ğŸ˜‚ã€‚

åœ¨äºŒæœˆä»½çš„æ—¶å€™å¸®å°åœŸè±†å’Œ nova åŒå­¦æµ‹è¯• webp server go çš„ benchmark ï¼Œè¿™ä¸ª pxder å¸®äº†å’±å¾ˆå¤§çš„å¿™ï¼Œä¸‹è½½äº† 3W å¤šå¼ å›¾ç‰‡åšæµ‹è¯•æ ·æœ¬ï¼Œæœ€ç»ˆä½¿ç”¨è„šæœ¬ç­›é€‰å‡ºåˆé€‚çš„æ–‡ä»¶å¤§å°æ¥è¿›è¡Œ prefetc æµ‹è¯•ã€‚

```shell
â•­â”€debian@debian /mnt/f/illustrations
â•°â”€$ du -sh
50G     .
â•­â”€debian@debian /mnt/f/illustrations
â•°â”€$ tree
203 directories, 31831 files
```

### æ‚ä¸ƒæ‚å…«çš„

#### nginx

nginxï¼Œé™¤äº†å»ºç«™ç•¶ Web æœå‹™å™¨ï¼Œæ˜¯å’±åœ¨ openwrt ä¸Šè£çš„ï¼Œç›®çš„æ˜¯ç‚ºäº†æ“ºè„« ip çš„è¾¦å®šé™åˆ¶ã€‚å› ç‚ºæœ‰äº›è¨­å‚™é€šéåŸŸåä¾†è¨ªå•ï¼Œæ›´æ›ç¶²çµ¡ç’°å¢ƒï¼Œæ¯”å¦‚æ¬å®¶ä¹‹å¾Œåªéœ€è¦ç¶­ä¿®æ”¹ä¸€ä¸‹åŸŸåè§£æå³å¯ã€‚æ¯”å¦‚å’±ä½¿ç”¨ X.lo.502.li ä½œç‚ºä¸‰ç´šå­åŸŸååˆ†é…çµ¦æœ¬åœ°å…§ç¶²æ©Ÿå™¨ç”¨ã€‚

#### ffmpeg

ffmpeg èƒ½å¹²çš„äº‹æƒ…å¤ªå¤šäº†ï¼Œå’±ä½¿ç”¨æœ€å¤šçš„è¿˜æ˜¯åˆå¹¶è§†é¢‘è½¬ç è§†é¢‘ï¼Œæ¯”å¦‚å’±çš„ [mbcf]() ï¼Œå…¨ç§° Merge bilibili cilent file

#### [pandoc](https://github.com/jgm/pandoc)

#### rsync

#### resilio sync

resilio sync ï¼Œæ˜¯å’±æœ€é‡è¦çš„æ•¸æ“šå‚™ä»½å·¥å…·ï¼Œæ¯”å¦‚å’±ä½¿ç”¨ pxder ä¸‹è¼‰å¥½æ”¶è—çš„è€å©†å€‘ï¼Œç‚ºäº†åœ¨æ‰‹æ©Ÿä¸Šä»”ç´°æ¬£è³è€å©†å€‘ï¼Œå’±å°±ç”¨ã€‚resilio sync å°‡ç›®éŒ„åŒæ­¥åˆ°æ‰‹æ©Ÿä¸Šï¼Œä¸¦ä¸”ä½¿ç”¨å®ƒä¾†èˆ‡ PCï¼ŒiPhone ï¼ŒAndroid ï¼ŒLinux ä¸‰è€…ç„¡ç¸«åŒæ­¥ã€‚ç°¡ç›´å¥½ç”¨æ¥µäº†ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè·¨å…¬ç¶²åŒæ­¥ï¼Œåœ¨ä¸€äº›ç¶²çµ¡ç’°å¢ƒä¸‹å› ç‚º GFW çš„ç·£æ•…ï¼Œç„¡æ³•å»ºç«‹èµ·éˆæ¥ï¼Œé€™æ™‚å€™éœ€è¦ä½¿ç”¨åˆ°é å®šç¾©ä¸»æ©Ÿã€‚å…¶ä¸­æœ‰å…©ç¨®æ¯”è¼ƒå¥½çš„æ–¹æ¡ˆï¼Œä¸€æ˜¯åœ¨å…¬ç¶² VPS æ©Ÿå™¨ä¸Šå®‰è£ resilio sync ä¸¦ä¸”åŠ å…¥åˆ°åŒæ­¥ä¸»æ©Ÿç•¶ä¸­ã€‚é€™é»ç¼ºé»ä¹Ÿæ˜é¡¯ï¼Œéœ€è¦ä½”ç”¨ç£ç›¤ç©ºé–“ï¼Œå¦‚æœåŒæ­¥å¤§é‡æ–‡ä»¶ä»¥åŠå¹¾åå¹¾ç™¾GBç´šåˆ¥çš„è©±ï¼Œå°ç›¤æ©Ÿæ˜¯æ‰›ä¸ä½çš„ï¼Œéœ€è¦å¦å¤–æ·»åŠ ç£ç›¤ã€‚æ–¹æ³•äºŒæ˜¯å’±æƒ³åˆ°çš„ï¼Œå±¢è©¦ä¸çˆ½ï¼Œå°±æ˜¯å°‡æœ¬æ©Ÿçš„ resilio sync ç›£è½ç«¯å£ 11354 ä½¿ç”¨ frp å…§ç¶²ç©¿é€åˆ°å…¬ç¶²æœå‹™å™¨ï¼Œç„¶å¾Œåœ¨å¦ä¸€å°æ©Ÿå™¨ä¸Šæ·»åŠ ä¸Šé å®šç¾©ä¸»æ©Ÿï¼ŒIP å°±æ˜¯ frp æœå‹™å™¨çš„ IPï¼Œç«¯å£å°±æ˜¯ frp å…§ç¶²ç©¿é€çš„ remote portã€‚é€™æ¨£æ·»åŠ å¥½é è¨‚èˆ‡ä¸»æ©Ÿä¹‹å¾Œï¼Œä¸åˆ°ä¸€åˆ†é˜å°±èƒ½ç™¼ç¾ä¸»æ©Ÿä¸¦å»ºç«‹èµ·é€£æ¥ã€‚

#### curl

#### wget

#### oh-my-zsh

#### zsh

#### frp

#### openwrt

#### Trojan

### shell å¸¸ç”¨è„šæœ¬

#### VPS init

```shell
apt update
apt install nload ncdu zsh git wget curl htop sysstat psmisc nginx-full fail2ban
curl  https://get.acme.sh | sh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
sed -i 's/ZSH_THEME="robbyrussell"/ZSH_THEME="bira"/g' ~/.zshrc
```

#### rawg

raw wget çš„ç¼©å†™

```shell
#!/bin/bash
# data: 2020-03-31
# author: muzi502
# for: Fuck GFW and download some raw file form github without proxy using jsDelivr CDN
# usage: save the .she to your local such as /usr/bin/rawg, and chmod +x /usr/bin/rawg
# use rawg https://github.com/ohmyzsh/ohmyzsh/blob/master/tools/install.sh to download

set -xue
# GitHub rul: https://github.com/ohmyzsh/ohmyzsh/blob/master/tools/install.sh
# jsDelivr url: https://cdn.jsdelivr.net/gh/ohmyzsh/ohmyzsh/tools/install.sh

wget $(echo $1 | sed 's/raw.githubusercontent.com/cdn.jsdelivr.net\/gh/' \
                | sed 's/github.com/cdn.jsdelivr.net\/gh/' \
                | sed 's/\/master//' | sed 's/\/blob//' )

# curl $(echo $1 | sed 's/raw.githubusercontent.com/cdn.jsdelivr.net\/gh/' \
#                | sed 's/github.com/cdn.jsdelivr.net\/gh/' \
#                | sed 's/\/master//' | sed 's/\/blob//' )
```

#### kubeadm pull images

```shell
#!/bin/bash
# for: pull kubeamd images and get kubeadm kubectl kubelet binary
# date: 2020-04-29
# author: muzi502

set -xue
apt-get update && apt-get install -y apt-transport-https curl
curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -
cat <<EOF >/etc/apt/sources.list.d/kubernetes.list
deb https://apt.kubernetes.io/ kubernetes-xenial main
EOF
apt-get update

for version in 1.17.5
do
    apt purge -y kubeadm kubelet kubectl
    apt install -y kubeadm=${version}-00 kubelet=${version}-00 kubectl=${version}-00
    mkdir -p ${version}/bin
    rm -rf ${version}/bin/*
    cp -a $(whereis kubelet | awk -F ":" '{print $2}') ${version}/bin/
    cp -a $(whereis kubeadm | awk -F ":" '{print $2}') ${version}/bin/
    cp -a $(whereis kubectl | awk -F ":" '{print $2}') ${version}/bin/
    kubeadm config images pull --kubernetes-version=${version}
    docker save -o kubeadm_v${version}.tar `kubeadm config images list --kubernetes-version=${version}`
    mv kubeadm_v${version}.tar ${version}
    tar -czvf ${version}{.tar.gz,}
done
```

#### ss-obfs

```shell

#/bin/bash
# for: install shadowsocks-libev and obfs
# date: 2019-03-11
# by: muzi502
apt-get update
apt-get -y  install shadowsocks-libev simple-obfs rng-tools
rngd -r /dev/urandom
mkdir -p /etc/shadowsocks-libev/

cat > /etc/shadowsocks-libev/config.json <<EOF
{
    "server":"0.0.0.0",
    "server_port":8964,
    "local_port":1080,
    "password":"1984fuckGFW",
    "timeout":60,
    "method":"chacha20",
    "plugin":"obfs-server",
    "plugin_opts":"obfs=http"
}
EOF
systemctl restart shadowsocks-libev.service
modprobe tcp_bbr
echo "tcp_bbr" >> /etc/modules-load.d/modules.conf
echo "net.core.default_qdisc=fq" >> /etc/sysctl.conf
echo "net.ipv4.tcp_congestion_control=bbr" >> /etc/sysctl.conf
sysctl -p
sysctl net.ipv4.tcp_available_congestion_control
sysctl net.ipv4.tcp_congestion_control
touch /etc/sysctl.d/local.conf
echo "net.core.wmem_max = 67108864" >>/etc/sysctl.d/local.conf
echo "net.core.rmem_default = 65536" >>/etc/sysctl.d/local.conf
echo "net.core.wmem_default = 65536" >>/etc/sysctl.d/local.conf
echo "net.core.netdev_max_backlog = 4096" >>/etc/sysctl.d/local.conf
echo "net.core.somaxconn = 4096" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_syncookies = 1" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_tw_reuse = 1" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_tw_recycle = 0" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_fin_timeout = 30" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_keepalive_time = 1200" >>/etc/sysctl.d/local.conf
echo "net.ipv4.ip_local_port_range = 10000 65000" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_max_syn_backlog = 4096" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_max_tw_buckets = 5000" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_fastopen = 3" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_rmem = 4096 87380 67108864" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_wmem = 4096 65536 67108864" >>/etc/sysctl.d/local.conf
echo "net.ipv4.tcp_mtu_probing = 1" >>/etc/sysctl.d/local.conf
sysctl --system
lsmod | grep bbr
```

#### mcbf

```shell
#!/bin/bash
# for: bulk merge bilibili UWP download file *.flv
# by: blog.502.li
# date: 2019-01-12
# å°†è¯¥è„šæ”¾åˆ° UWP å®¢æˆ·ç«¯ä¸‹è½½ç¼“å­˜ä¸»ç›®å½•ä¸‹æ‰§è¡Œï¼Œå®‰è£… ffmpegã€jq

set -xu
download_dir=$(pwd)
mp4_dir=${download_dir}/mp4
mkdir -p ${mp4_dir}

for video_dir in $(ls | sort -n | grep -E -v "\.|mp4")
do
  cd ${download_dir}/${video_dir}
  up_name=$(jq ".Uploader" *.dvi | tr -d "[:punct:]\040\011\012\015")
  mkdir -p ${mp4_dir}/${up_name}
  for p_dir in $(ls | sort -n | grep -v "\.")
  do
    cd ${download_dir}/${video_dir}/${p_dir}
    video_name=$(jq ".Title" *.info | tr -d "[:punct:]\040\011\012\015")
    part_name=$(jq ".PartName" *.info | tr -d "[:punct:]\040\011\012\015")
    upload_time=$(grep -Eo "20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]" *.info)
    Uploader=$(jq ".Uploader" *.info | tr -d "[:punct:]\040\011\012\015")
    mp4_audio=$(jq ".VideoDashInfo" *.info | tr -d "[:punct:]\040\011\012\015")

    if [ "null" = "${part_name}" ];then
    mp4_file_name=${video_name}.mp4
    else
    mp4_file_name=${video_name}_${p_dir}_${part_name}.mp4
    fi

    if [ "null" = "${mp4_audio}" ];then
    ls *.flv | sort -n > ff.txt
    sed -i 's/^/file /g' ff.txt
    ffmpeg -f concat -i ff.txt -c copy ${mp4_dir}/${up_name}/"${mp4_file_name}";rm -rf ff.txt
    else
    ffmpeg  -i video.mp4 -i audio1.mp4 -c:v copy -c:a copy ${mp4_dir}/${up_name}/"${mp4_file_name}"
    fi
    cd ${download_dir}/${video_dir}
  cd ${download_dir}
  done
# å¦‚æœéœ€è¦ä¿ç•™åŸè§†é¢‘è¯·æ³¨é‡Šæ‰ä¸‹é¢è¿™ä¸€è¡Œ
#rm -rf ${download_dir}/${video_dir}
done
```

#### conoha wallpaper download

```shell
#!/bin/bash
# for: download conoha wallpaper
# by: muzi502
# date: 2020-02-11
set -xue

p=$(curl https://conoha.mikumo.com/wallpaper/ \
| grep li | grep data-wallpaper-design= \
| sed -e 's/<li//g' | sed -e 's/">//g' | sed -e 's/^[ \t]*//g' \
| sed -e 's/data-wallpaper-design="//g' \
| sed 's/^/https:\/\/conoha.mikumo.com\/wp-content\/themes\/conohamikumo\/images\/wallpaper\//')

for pic in ${p}
do
    file_name=$(echo ${pic} | awk -F "/" '{print $9}')
    wget ${pic}/1080_1920.jpg -O ${file_name}_1080.jpg
    wget ${pic}/2560_1440.jpg -O ${file_name}_1440.jpg
done
```

## å‚è€ƒ

- [[DevOps] Linuxæ“ä½œç³»ç»Ÿå±‚çš„æ•…éšœæ³¨å…¥](http://code2life.top/2019/05/02/0035-fault-injection/)